---
phase: 08-cleanup-helm-update
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - README.md
  - chart/README.md
autonomous: true

must_haves:
  truths:
    - "Project README describes consolidated single-container architecture"
    - "README shows MCP available on port 8080 at /v1/mcp path"
    - "Helm chart README describes single-container deployment"
    - "Documentation mentions no MCP sidecar or port 8082"
  artifacts:
    - path: "README.md"
      provides: "Project overview with consolidated architecture"
      not_contains: "MCP sidecar"
      not_contains: "8082"
      not_contains: "localhost:3000"
      contains: "port 8080"
    - path: "chart/README.md"
      provides: "Helm chart documentation without sidecar references"
      not_contains: "MCP sidecar"
      not_contains: "mcp.enabled"
      exists: true
  key_links: []
---

<objective>
Update project README and Helm chart documentation to reflect consolidated single-container architecture with integrated MCP server.

Purpose: Documentation must match actual architecture from Phase 6. Users reading docs should understand MCP runs in-process on main server port 8080, not as separate sidecar on port 8082.

Output: Updated README.md and chart/README.md with accurate architecture descriptions and deployment instructions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-cleanup-helm-update/08-CONTEXT.md
@.planning/phases/08-cleanup-helm-update/08-RESEARCH.md

@README.md
</context>

<tasks>

<task type="auto">
  <name>Update project README architecture description</name>
  <files>README.md</files>
  <action>
Review and update README.md to remove MCP sidecar architecture references:

**Section to check: "MCP Integration"**

Verify the MCP Integration section accurately describes:
1. MCP server runs **in the main Spectre server process** (not as separate container/process)
2. MCP available on **port 8080 at /v1/mcp path** (not separate port 8082)
3. Single-port deployment model

**If any of these outdated references exist, update them:**

- "MCP sidecar" -> "integrated MCP server" or "MCP endpoint"
- "port 8082" -> "port 8080 at /v1/mcp"
- "localhost:3000" -> "localhost:8080" (if found in examples)
- "separate MCP container" -> "MCP runs in-process"
- "MCP HTTP server (sidecar)" -> "MCP endpoint on main server"

**Quick Start section:**

If port forwarding examples exist, ensure they show:
```bash
kubectl port-forward -n monitoring svc/spectre 8080:8080
```

Not separate port forwarding for MCP. All functionality available on port 8080.

**Architecture descriptions:**

If any architecture diagrams or text descriptions show two containers (Spectre + MCP sidecar), update to show single container with multiple capabilities:
- REST API on /api/v1/*
- Web UI on /
- MCP endpoint on /v1/mcp

**Testing/Development sections:**

Update any testing or development instructions that reference:
- Running standalone MCP server with `spectre mcp` command (now: use `spectre server`)
- Connecting to MCP on port 8082 (now: connect to port 8080 /v1/mcp path)

**Do NOT add new sections** about migration or deprecation. This is not a migration guide - just ensure current documentation accurately describes current architecture.

Context decisions specify "minimal update to Helm chart README - remove MCP sidecar references, keep structure." Same applies here: minimal targeted updates, not rewrites.
  </action>
  <verify>
```bash
# Should return no matches (outdated terms removed)
grep -n "sidecar" README.md
grep -n "8082" README.md
grep -n "localhost:3000" README.md

# Should contain accurate references
grep -n "port 8080" README.md
grep -n "/v1/mcp" README.md

# Verify MCP Integration section exists and is accurate
grep -A 20 "## MCP Integration" README.md
```
  </verify>
  <done>
- README.md updated to describe consolidated architecture
- No references to MCP sidecar or port 8082
- MCP described as integrated endpoint on port 8080 at /v1/mcp
- Port forwarding examples show single port 8080
  </done>
</task>

<task type="auto">
  <name>Update Helm chart README if it exists</name>
  <files>chart/README.md</files>
  <action>
Check if chart/README.md exists:
```bash
ls /home/moritz/dev/spectre-via-ssh/chart/README.md 2>/dev/null
```

If the file exists, update it to remove MCP sidecar references:

**Deployment architecture:**
- Update descriptions showing MCP as integrated endpoint (not sidecar)
- Remove references to mcp.enabled value (no longer exists)
- Remove references to mcp.port value (no longer exists)
- Update any architecture diagrams showing two containers

**Configuration values:**
- If file lists available values, remove mcp.* values section
- Mention MCP available at /v1/mcp on main service port

**Examples:**
- Update deployment examples that configure MCP sidecar
- Remove examples showing mcp.enabled: true/false
- Remove examples showing mcp.port: 8082

If chart/README.md does NOT exist, skip this file (no update needed). Many Helm charts don't have a separate README, relying instead on values.yaml comments for documentation.

Context decisions specify "minimal update to Helm chart README - remove MCP sidecar references, keep structure." Focus on accuracy, not comprehensive rewrites.
  </action>
  <verify>
```bash
# Check if chart README exists
if [ -f /home/moritz/dev/spectre-via-ssh/chart/README.md ]; then
  echo "chart/README.md exists, checking content..."

  # Should not contain sidecar references
  grep -n "sidecar" chart/README.md
  grep -n "mcp.enabled" chart/README.md
  grep -n "8082" chart/README.md

  echo "Verification complete"
else
  echo "chart/README.md does not exist, no update needed"
fi
```
  </verify>
  <done>
- If chart/README.md exists: Updated to describe single-container deployment, MCP sidecar references removed
- If chart/README.md does not exist: No action needed, skipped
- Helm chart documented through values.yaml comments (always present)
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. README.md verification:
   - No mentions of "MCP sidecar" or "sidecar container"
   - No references to port 8082
   - MCP described as available on port 8080 at /v1/mcp
   - Port forwarding examples show single port

2. chart/README.md verification (if exists):
   - No MCP sidecar references
   - No mcp.enabled or mcp.port value documentation
   - Single-container architecture described

3. Accuracy verification:
   - Documentation matches Phase 6 implementation (consolidated server)
   - No contradictions with actual deployment behavior
   - Users can successfully deploy and use Spectre following updated docs
</verification>

<success_criteria>
- Project README accurately describes consolidated architecture
- No references to deprecated MCP sidecar, port 8082, or standalone MCP command
- MCP Integration section describes in-process MCP on port 8080 at /v1/mcp
- Helm chart documentation (if exists) updated to remove sidecar references
- Documentation is minimal update (not full rewrite) per context decisions
</success_criteria>

<output>
After completion, create `.planning/phases/08-cleanup-helm-update/08-03-SUMMARY.md`
</output>
