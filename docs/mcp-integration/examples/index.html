<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-mcp-integration/examples" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">MCP Real-World Examples | Spectre</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://moolen.github.io/spectre/img/spectre-social-card.png"><meta data-rh="true" name="twitter:image" content="https://moolen.github.io/spectre/img/spectre-social-card.png"><meta data-rh="true" property="og:url" content="https://moolen.github.io/spectre/docs/mcp-integration/examples"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="MCP Real-World Examples | Spectre"><meta data-rh="true" name="description" content="Complete investigation scenarios demonstrating Spectre MCP capabilities"><meta data-rh="true" property="og:description" content="Complete investigation scenarios demonstrating Spectre MCP capabilities"><meta data-rh="true" name="keywords" content="examples,mcp,claude,scenarios,investigations,troubleshooting,post-mortem"><link data-rh="true" rel="icon" href="/spectre/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://moolen.github.io/spectre/docs/mcp-integration/examples"><link data-rh="true" rel="alternate" href="https://moolen.github.io/spectre/docs/mcp-integration/examples" hreflang="en"><link data-rh="true" rel="alternate" href="https://moolen.github.io/spectre/docs/mcp-integration/examples" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"MCP Integration","item":"https://moolen.github.io/spectre/docs/mcp-integration/"},{"@type":"ListItem","position":2,"name":"MCP Real-World Examples","item":"https://moolen.github.io/spectre/docs/mcp-integration/examples"}]}</script><link rel="stylesheet" href="/spectre/assets/css/styles.d42b8c2d.css">
<script src="/spectre/assets/js/runtime~main.2344fe77.js" defer="defer"></script>
<script src="/spectre/assets/js/main.7008b389.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/spectre/"><div class="navbar__logo"><img src="/spectre/img/ghost.svg" alt="Spectre Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/spectre/img/ghost.svg" alt="Spectre Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Spectre</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/spectre/docs/intro">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/moolen/spectre" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/spectre/docs/intro"><span title="Introduction to Spectre" class="linkLabel_WmDU">Introduction to Spectre</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/spectre/docs/getting-started/"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Collapse sidebar category &#x27;Getting Started&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/spectre/docs/getting-started/quick-start"><span title="Quick Start" class="linkLabel_WmDU">Quick Start</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/spectre/docs/getting-started/demo-mode"><span title="Demo Mode" class="linkLabel_WmDU">Demo Mode</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/spectre/docs/installation/"><span title="Installation" class="categoryLinkLabel_W154">Installation</span></a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/spectre/docs/configuration/"><span title="Configuration" class="categoryLinkLabel_W154">Configuration</span></a><button aria-label="Expand sidebar category &#x27;Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/spectre/docs/user-guide/"><span title="User Guide" class="categoryLinkLabel_W154">User Guide</span></a><button aria-label="Expand sidebar category &#x27;User Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/spectre/docs/use-cases/"><span title="Use Cases" class="categoryLinkLabel_W154">Use Cases</span></a><button aria-label="Expand sidebar category &#x27;Use Cases&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/spectre/docs/mcp-integration/"><span title="MCP Integration" class="categoryLinkLabel_W154">MCP Integration</span></a><button aria-label="Collapse sidebar category &#x27;MCP Integration&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/spectre/docs/mcp-integration/getting-started"><span title="Getting Started with MCP" class="linkLabel_WmDU">Getting Started with MCP</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/spectre/docs/mcp-integration/tools-reference/cluster-health"><span title="Tools Reference" class="categoryLinkLabel_W154">Tools Reference</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/spectre/docs/mcp-integration/prompts-reference/post-mortem"><span title="Prompts Reference" class="categoryLinkLabel_W154">Prompts Reference</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/spectre/docs/mcp-integration/claude-integration"><span title="Claude Desktop Integration" class="linkLabel_WmDU">Claude Desktop Integration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/spectre/docs/mcp-integration/examples"><span title="MCP Real-World Examples" class="linkLabel_WmDU">MCP Real-World Examples</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/spectre/docs/architecture/"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a><button aria-label="Expand sidebar category &#x27;Architecture&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/spectre/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/spectre/docs/mcp-integration/"><span>MCP Integration</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">MCP Real-World Examples</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>MCP Real-World Examples</h1></header>
<p>Practical scenarios demonstrating how to use Spectre&#x27;s MCP integration for Kubernetes troubleshooting, incident investigation, and post-mortem analysis.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>This guide presents <strong>complete, end-to-end examples</strong> showing:</p>
<ul>
<li class="">Claude Desktop conversations (natural language)</li>
<li class="">Direct HTTP API calls (programmatic access)</li>
<li class="">Expected tool outputs</li>
<li class="">How to interpret results and take action</li>
</ul>
<p><strong>Scenarios covered</strong>:</p>
<ol>
<li class="">CrashLoopBackOff Investigation</li>
<li class="">Post-Mortem Analysis (Complete Workflow)</li>
<li class="">Live Incident Handling</li>
<li class="">Resource Change Correlation</li>
<li class="">Multi-Namespace Investigation</li>
<li class="">Custom Resource Investigation (Flux GitRepository)</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-1-crashloopbackoff-investigation">Example 1: CrashLoopBackOff Investigation<a href="#example-1-crashloopbackoff-investigation" class="hash-link" aria-label="Direct link to Example 1: CrashLoopBackOff Investigation" title="Direct link to Example 1: CrashLoopBackOff Investigation" translate="no">​</a></h2>
<p><strong>Scenario</strong>: You receive an alert that pods are failing in the production namespace. You don&#x27;t know which pods or why.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="via-claude-desktop">Via Claude Desktop<a href="#via-claude-desktop" class="hash-link" aria-label="Direct link to Via Claude Desktop" title="Direct link to Via Claude Desktop" translate="no">​</a></h3>
<p><strong>You</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">I got an alert about pods failing in production. Can you investigate?</span><br></span></code></pre></div></div>
<p><strong>Claude</strong> (Step 1 - Discovery):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Automatically calling cluster_health tool]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I found issues in your production namespace. Let me investigate...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cluster Health Status: Warning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resources in Production Namespace:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Pods: 8 total (5 healthy, 3 error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Deployments: 3 total (2 healthy, 1 warning)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Services: 4 total (all healthy)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Top Issues:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Pod &quot;api-server-85f6c9b8-k4x2p&quot; - Error (CrashLoopBackOff)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Pod &quot;api-server-85f6c9b8-m9n4r&quot; - Error (CrashLoopBackOff)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Pod &quot;api-server-85f6c9b8-p2q7t&quot; - Error (CrashLoopBackOff)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">All three pods belong to Deployment &quot;api-server&quot;. Would you like me to investigate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">the deployment timeline to see what changed?</span><br></span></code></pre></div></div>
<p><strong>You</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Yes, investigate the deployment</span><br></span></code></pre></div></div>
<p><strong>Claude</strong> (Step 2 - Investigation):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Calling investigate tool for Deployment/production/api-server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Timeline for api-server Deployment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:05:12] Status: Ready → Warning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Image updated: registry.example.com/api-server:v1.2.0 → v1.3.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:05:45] New pods failed to start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Event: &quot;Back-off restarting failed container&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:06:30] Status: Warning (ReplicaFailure)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Event: &quot;Failed to pull image registry.example.com/api-server:v1.3.0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   authentication required&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Root Cause Analysis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The deployment updated to image v1.3.0, but pods cannot pull the image due</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">to authentication failure. This is likely an imagePullSecrets issue.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Immediate Actions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Verify imagePullSecrets are configured:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   kubectl get deployment api-server -n production -o yaml | grep imagePullSecrets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Check if secret exists:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   kubectl get secret regcred -n production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Rollback deployment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   kubectl rollout undo deployment/api-server -n production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Check image exists in registry:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   docker pull registry.example.com/api-server:v1.3.0</span><br></span></code></pre></div></div>
<p><strong>You</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Runs kubectl commands, confirms secret is missing]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Creates secret and redeploys]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thanks! That solved it.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="via-http-api-programmatic">Via HTTP API (Programmatic)<a href="#via-http-api-programmatic" class="hash-link" aria-label="Direct link to Via HTTP API (Programmatic)" title="Direct link to Via HTTP API (Programmatic)" translate="no">​</a></h3>
<p>Same investigation without Claude:</p>
<p><strong>Step 1: Cluster Health Check</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> POST http://localhost:8081/mcp/v1 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Content-Type: application/json&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">jsonrpc</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">2.0</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">method</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">tools/call</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">params</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">name</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">cluster_health</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">arguments</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">start_time</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">date</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-d</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&#x27;1 hour ago&#x27;</span><span class="token string variable" style="color:#36acaa"> +%s</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">end_time</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">date</span><span class="token string variable" style="color:#36acaa"> +%s</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">namespace</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">production</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">id</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  }&quot;</span><br></span></code></pre></div></div>
<p><strong>Response</strong> (abbreviated):</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;jsonrpc&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2.0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;result&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;content&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;text&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;text&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{\&quot;overall_status\&quot;:\&quot;Warning\&quot;,\&quot;resources_by_kind\&quot;:[{\&quot;kind\&quot;:\&quot;Pod\&quot;,\&quot;total\&quot;:8,\&quot;healthy\&quot;:5,\&quot;error\&quot;:3}],\&quot;top_issues\&quot;:[{\&quot;kind\&quot;:\&quot;Pod\&quot;,\&quot;name\&quot;:\&quot;api-server-85f6c9b8-k4x2p\&quot;,\&quot;namespace\&quot;:\&quot;production\&quot;,\&quot;status\&quot;:\&quot;Error\&quot;,\&quot;message\&quot;:\&quot;CrashLoopBackOff\&quot;}]}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><strong>Step 2: Investigate Deployment</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> POST http://localhost:8081/mcp/v1 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Content-Type: application/json&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">jsonrpc</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">2.0</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">method</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">tools/call</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">params</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">name</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">investigate</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">arguments</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">resource_kind</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">Deployment</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">resource_name</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">api-server</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">namespace</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">production</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">start_time</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">date</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-d</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&#x27;1 hour ago&#x27;</span><span class="token string variable" style="color:#36acaa"> +%s</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">end_time</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">date</span><span class="token string variable" style="color:#36acaa"> +%s</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">investigation_type</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">incident</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">id</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  }&quot;</span><br></span></code></pre></div></div>
<p><strong>Response</strong> includes timeline with image update and failure events.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-2-post-mortem-analysis-complete-workflow">Example 2: Post-Mortem Analysis (Complete Workflow)<a href="#example-2-post-mortem-analysis-complete-workflow" class="hash-link" aria-label="Direct link to Example 2: Post-Mortem Analysis (Complete Workflow)" title="Direct link to Example 2: Post-Mortem Analysis (Complete Workflow)" translate="no">​</a></h2>
<p><strong>Scenario</strong>: Yesterday there was a 15-minute outage. You need a comprehensive post-mortem report.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="via-claude-desktop-1">Via Claude Desktop<a href="#via-claude-desktop-1" class="hash-link" aria-label="Direct link to Via Claude Desktop" title="Direct link to Via Claude Desktop" translate="no">​</a></h3>
<p><strong>You</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Run a post-mortem analysis for the incident yesterday from 14:00 to 14:30 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">in the production namespace</span><br></span></code></pre></div></div>
<p><strong>Claude</strong> (Using <code>post_mortem_incident_analysis</code> prompt):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Executing post-mortem analysis prompt with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  start_time: 2024-12-11 14:00 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end_time: 2024-12-11 14:30 UTC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: production]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Incident Post-Mortem Report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Incident Summary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Service outage in production namespace caused by ConfigMap deletion,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">affecting api-server deployment for 15 minutes. Service was restored</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">after ConfigMap was manually recreated from backup.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Timeline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[14:00:05] **ConfigMap/production/api-config** - Deleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Impact Score: 0.75 (high)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[14:02:18] **Deployment/production/api-server** - Triggered rolling update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           (ConfigMap referenced in pod spec)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[14:02:45] **Pod/production/api-server-7d9f8c5b-x7k2p** - Status: Running → Error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Event: &quot;Error: ConfigMap api-config not found&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[14:02:52] **Pod/production/api-server-7d9f8c5b-z9k3p** - Status: Running → Error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           (Same error)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[14:03:00] **Service/production/api-server** - No ready endpoints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           All pods unhealthy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[14:15:30] **ConfigMap/production/api-config** - Created (restored from backup)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[14:15:55] **Pod/production/api-server-9c8f7b6d-a3m5n** - Status: Running</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           (New pod started successfully)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[14:16:10] **Service/production/api-server** - Endpoints restored</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Service traffic resumed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Root Cause Analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Primary Cause**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ConfigMap &quot;api-config&quot; was deleted, causing all pods referencing it to fail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">during the subsequent rolling update.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Contributing Factors**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. No version control or backup system for ConfigMaps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Deployment configuration requires ConfigMap, but has no failure handling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. No RBAC restrictions preventing ConfigMap deletion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. No monitoring alerts on ConfigMap changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. Manual restoration took 15 minutes (no documented procedure)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Evidence**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- resource_changes tool: ConfigMap deletion at 14:00:05 (impact_score: 0.75)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- investigate tool: Pods transitioned Running → Error at 14:02:45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Kubernetes events: &quot;ConfigMap api-config not found&quot; (count: 24)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Impact Assessment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Service Impact**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Total downtime: 15 minutes 55 seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Affected services: api-server (100% unavailable)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Error rate: 100% during outage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Resources Affected**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 1 ConfigMap (deleted)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 1 Deployment (failed rollout)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 3 Pods (failed to start)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 1 Service (no endpoints)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**User Impact**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- API requests returned 503 errors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Estimated affected users: ~500 (based on typical traffic)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Recommendations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Immediate Actions**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. ✅ Restore ConfigMap from backup (completed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. ✅ Verify all pods are healthy (completed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. ⏳ Document ConfigMap restoration procedure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Short-Term (This Week)**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Implement GitOps for ConfigMap management (FluxCD/ArgoCD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Add RBAC policy restricting ConfigMap deletions in production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Set up alerts for ConfigMap changes (via Prometheus or kube-state-metrics)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Add readiness probes with longer failure thresholds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Long-Term (This Quarter)**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Implement automated ConfigMap backup system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Add application fallback to default configuration values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Create runbook for ConfigMap-related incidents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Review all deployments for critical ConfigMap dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Data Gaps &amp; Follow-Up Investigation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To complete the analysis, the following information is needed:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. **Who deleted the ConfigMap?**</span><br></span></code></pre></div></div>
<p>kubectl logs -n kube-system -l component=kube-apiserver <br>
<!-- -->| grep &quot;ConfigMap.*api-config.*delete&quot;</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. **Application error logs**:</span><br></span></code></pre></div></div>
<p>kubectl logs -n production api-server-7d9f8c5b-x7k2p --previous</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. **Monitoring data**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Check Prometheus for request rate drop at 14:03</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Review alerting timeline (did alerts fire?)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- External monitoring (Datadog, New Relic) for user impact</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. **Related changes**:</span><br></span></code></pre></div></div>
<p>git log --since=&quot;2024-12-11 13:00&quot; --until=&quot;2024-12-11 14:00&quot; <br>
<!-- -->-- k8s/production/configmaps/</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Lessons Learned</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**What Went Well**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Incident was detected within 3 minutes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ConfigMap backup was available</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Team restored service within 16 minutes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**What Went Wrong**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- No prevention mechanisms for accidental deletion</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- No automated recovery process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Lack of graceful degradation in application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Action Items**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [ ] @ops-team: Implement GitOps for ConfigMaps (by Dec 18)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [ ] @ops-team: Add RBAC restrictions (by Dec 15)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [ ] @dev-team: Add ConfigMap change alerts (by Dec 20)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [ ] @dev-team: Implement application fallback config (by Q1 2025)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [ ] @all: Review and update incident runbooks (by Dec 22)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="via-http-api">Via HTTP API<a href="#via-http-api" class="hash-link" aria-label="Direct link to Via HTTP API" title="Direct link to Via HTTP API" translate="no">​</a></h3>
<p>Use the <code>post_mortem_incident_analysis</code> prompt via HTTP:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Convert timestamps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">START_TIME</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">date</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable parameter variable" style="color:#36acaa">-u</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable parameter variable" style="color:#36acaa">-d</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable string" style="color:#e3116c">&quot;2024-12-11 14:00:00&quot;</span><span class="token variable" style="color:#36acaa"> +%s</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">END_TIME</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">date</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable parameter variable" style="color:#36acaa">-u</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable parameter variable" style="color:#36acaa">-d</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable string" style="color:#e3116c">&quot;2024-12-11 14:30:00&quot;</span><span class="token variable" style="color:#36acaa"> +%s</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-X</span><span class="token plain"> POST http://localhost:8081/mcp/v1 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Content-Type: application/json&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">jsonrpc</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">2.0</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">method</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">prompts/get</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">params</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">name</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">post_mortem_incident_analysis</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">arguments</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">start_time</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string variable" style="color:#36acaa">$START_TIME</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">end_time</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string variable" style="color:#36acaa">$END_TIME</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">namespace</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">production</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">incident_description</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">API service outage</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    </span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">id</span><span class="token string entity" style="color:#36acaa">\&quot;</span><span class="token string" style="color:#e3116c">: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  }&quot;</span><br></span></code></pre></div></div>
<p>Response includes the prompt that instructs the LLM to execute the 9-step post-mortem workflow.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-3-live-incident-handling">Example 3: Live Incident Handling<a href="#example-3-live-incident-handling" class="hash-link" aria-label="Direct link to Example 3: Live Incident Handling" title="Direct link to Example 3: Live Incident Handling" translate="no">​</a></h2>
<p><strong>Scenario</strong>: Pods are failing RIGHT NOW. You need immediate guidance.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="via-claude-desktop-2">Via Claude Desktop<a href="#via-claude-desktop-2" class="hash-link" aria-label="Direct link to Via Claude Desktop" title="Direct link to Via Claude Desktop" translate="no">​</a></h3>
<p><strong>You</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Pods in production namespace are failing right now. Help me troubleshoot!</span><br></span></code></pre></div></div>
<p><strong>Claude</strong> (Using <code>live_incident_handling</code> prompt):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Executing live incident handling prompt with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  incident_start_time: now - 10 minutes (estimated)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  namespace: production]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Live Incident Triage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Current Situation (as of 10:15:30)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Incident started approximately 10 minutes ago (10:05).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Critical Issues**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- 5 Pods in Error state (all api-server pods)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Deployment &quot;api-server&quot; in Warning state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Service &quot;api-server&quot; has 0/5 ready endpoints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Recent Changes (Last 15 Minutes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Calling resource_changes tool]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">High-impact changes detected:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. **[10:04:12] Deployment/production/api-server**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Image updated: v1.2.0 → v1.3.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Impact Score: 0.80 (very high)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Status transitions: Ready → Warning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. **[10:04:05] ConfigMap/production/api-config**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - ConfigMap updated (3 fields changed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - Impact Score: 0.45 (medium)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Timeline of Failures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Calling investigate tool for Deployment/api-server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:04:12] Deployment updated (image + ConfigMap reference)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:04:45] First pod failed to start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Event: &quot;Error: environment variable DATABASE_URL not set&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:05:10] All pods failing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Status: CrashLoopBackOff (restart count: 8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Root Cause (Likely)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The deployment update introduced a new image (v1.3.0) that requires</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">environment variable DATABASE_URL, but this variable is not defined</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">in the updated ConfigMap.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Evidence**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Pod events show &quot;environment variable DATABASE_URL not set&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ConfigMap was updated 7 seconds before deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- New image version likely added new required config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Immediate Mitigation Steps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Option 1: Rollback Deployment (Fastest - 30-60 seconds)**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout undo deployment/api-server -n production</span><br></span></code></pre></div></div>
<p><strong>Option 2: Fix ConfigMap (If rollback not preferred)</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Add missing variable to ConfigMap</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl edit configmap api-config </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add: DATABASE_URL: &quot;postgresql://...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Restart deployment to pick up new config</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout restart deployment/api-server </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> production</span><br></span></code></pre></div></div>
<p><strong>Option 3: Emergency Patch</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Add env var directly to deployment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">env</span><span class="token plain"> deployment/api-server </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> production </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token assign-left variable" style="color:#36acaa">DATABASE_URL</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;postgresql://postgres:5432/api&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="recommended-action">Recommended Action<a href="#recommended-action" class="hash-link" aria-label="Direct link to Recommended Action" title="Direct link to Recommended Action" translate="no">​</a></h3>
<p><strong>ROLLBACK NOW</strong> (Option 1) for fastest recovery, then fix the configuration
issue before re-deploying v1.3.0.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="monitoring-for-recovery">Monitoring for Recovery<a href="#monitoring-for-recovery" class="hash-link" aria-label="Direct link to Monitoring for Recovery" title="Direct link to Monitoring for Recovery" translate="no">​</a></h3>
<p>After executing rollback:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Watch pod status (should become Running in 30-60 sec)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> production </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">app</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">api-server </span><span class="token parameter variable" style="color:#36acaa">-w</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Verify service endpoints restored</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get endpoints api-server </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check for new errors</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get events </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> production --sort-by</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;.lastTimestamp&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">head</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-20</span><br></span></code></pre></div></div>
<p><strong>Expected Recovery Time</strong>: 30-60 seconds after rollback</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="follow-up-actions-after-recovery">Follow-Up Actions (After Recovery)<a href="#follow-up-actions-after-recovery" class="hash-link" aria-label="Direct link to Follow-Up Actions (After Recovery)" title="Direct link to Follow-Up Actions (After Recovery)" translate="no">​</a></h3>
<ol>
<li class="">
<p>Verify rollback succeeded:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout status deployment/api-server -n production</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Check why v1.3.0 requires DATABASE_URL:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Review image changelog or contact dev team</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Update ConfigMap with missing variable</p>
</li>
<li class="">
<p>Test v1.3.0 in staging environment before re-deploying</p>
</li>
<li class="">
<p>Run full post-mortem analysis:
&quot;Run post_mortem_incident_analysis from 10:00 to 10:20&quot;</p>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="additional-investigation-needed">Additional Investigation Needed<a href="#additional-investigation-needed" class="hash-link" aria-label="Direct link to Additional Investigation Needed" title="Direct link to Additional Investigation Needed" translate="no">​</a></h3>
<p>If rollback doesn&#x27;t resolve the issue:</p>
<ol>
<li class="">
<p>Check container logs:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs api-server-85f6c9b8-k4x2p -n production --previous</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Verify image exists and is accessible:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe pod &lt;pod-name&gt; -n production | grep -A5 Events</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Check for resource constraints:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl top pods -n production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe nodes</span><br></span></code></pre></div></div>
</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Example 4: Resource Change Correlation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Scenario**: You notice degraded performance. You want to see what changed in the last 30 minutes.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Via Claude Desktop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**You**:</span><br></span></code></pre></div></div>
<p>Show me all high-impact changes in the production namespace
from 30 minutes ago to now</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Claude**:</span><br></span></code></pre></div></div>
<p>[Calling resource_changes tool]</p>
<p>High-impact changes in production (last 30 minutes):</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="changes-with-impact-score--05">Changes with Impact Score &gt; 0.5<a href="#changes-with-impact-score--05" class="hash-link" aria-label="Direct link to Changes with Impact Score &gt; 0.5" title="Direct link to Changes with Impact Score &gt; 0.5" translate="no">​</a></h3>
<ol>
<li class="">
<p><strong>Deployment/production/api-server</strong> (Impact: 0.80)</p>
<ul>
<li class="">Changed at: 10:04:12</li>
<li class="">Image: v1.2.0 → v1.3.0</li>
<li class="">Status transitions: Ready → Warning → Ready</li>
<li class="">Error events: 15</li>
<li class="">Rollback performed at 10:08:30</li>
</ul>
</li>
<li class="">
<p><strong>ConfigMap/production/api-config</strong> (Impact: 0.65)</p>
<ul>
<li class="">Changed at: 10:04:05</li>
<li class="">3 fields modified</li>
<li class="">Associated with deployment failure above</li>
</ul>
</li>
<li class="">
<p><strong>HPA/production/api-server-hpa</strong> (Impact: 0.55)</p>
<ul>
<li class="">Changed at: 10:15:00</li>
<li class="">Scaled: 3 → 5 replicas (due to increased load during incident)</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="changes-with-impact-score-03-05">Changes with Impact Score 0.3-0.5<a href="#changes-with-impact-score-03-05" class="hash-link" aria-label="Direct link to Changes with Impact Score 0.3-0.5" title="Direct link to Changes with Impact Score 0.3-0.5" translate="no">​</a></h3>
<ol start="4">
<li class="">
<p><strong>Service/production/api-server</strong> (Impact: 0.40)</p>
<ul>
<li class="">Warning events: 5</li>
<li class="">Endpoints removed/restored (correlated with pod failures)</li>
</ul>
</li>
<li class="">
<p><strong>Pod/production/cache-redis-0</strong> (Impact: 0.35)</p>
<ul>
<li class="">Warning at: 10:12:15</li>
<li class="">High restart count (3 restarts)</li>
<li class="">Event: &quot;Liveness probe failed&quot;</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="correlation-analysis">Correlation Analysis<a href="#correlation-analysis" class="hash-link" aria-label="Direct link to Correlation Analysis" title="Direct link to Correlation Analysis" translate="no">​</a></h3>
<p>The timeline suggests:</p>
<ol>
<li class="">ConfigMap updated (10:04:05)</li>
<li class="">Deployment updated shortly after (10:04:12)</li>
<li class="">Pods failed due to missing configuration (10:04:45)</li>
<li class="">Service unavailable (10:05:00)</li>
<li class="">Rollback performed (10:08:30)</li>
<li class="">HPA scaled up (10:15:00) to handle recovery traffic</li>
</ol>
<p>The redis pod restarts (10:12:15) may be a side effect of the increased
load during the incident, or a separate issue. Would you like me to
investigate the redis pod?</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Example 5: Multi-Namespace Investigation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Scenario**: You suspect an issue is affecting multiple namespaces.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Via Claude Desktop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**You**:</span><br></span></code></pre></div></div>
<p>Check cluster health across all namespaces and identify any problems</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Claude**:</span><br></span></code></pre></div></div>
<p>[Calling cluster_health without namespace filter]</p>
<p>Cluster-Wide Health Status: Warning</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="overall-summary">Overall Summary<a href="#overall-summary" class="hash-link" aria-label="Direct link to Overall Summary" title="Direct link to Overall Summary" translate="no">​</a></h3>
<ul>
<li class="">Total resources tracked: 247</li>
<li class="">Healthy: 228 (92%)</li>
<li class="">Warning: 14 (6%)</li>
<li class="">Error: 5 (2%)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="issues-by-namespace">Issues by Namespace<a href="#issues-by-namespace" class="hash-link" aria-label="Direct link to Issues by Namespace" title="Direct link to Issues by Namespace" translate="no">​</a></h3>
<p><strong>production</strong> (3 errors, 2 warnings):</p>
<ul>
<li class="">Pods: 3 in Error (api-server deployment)</li>
<li class="">Deployments: 1 in Warning</li>
</ul>
<p><strong>staging</strong> (2 errors, 5 warnings):</p>
<ul>
<li class="">Pods: 2 in Error (database-migration job)</li>
<li class="">Jobs: 1 Failed</li>
</ul>
<p><strong>monitoring</strong> (0 errors, 4 warnings):</p>
<ul>
<li class="">Pods: 4 in Warning (prometheus-server high memory)</li>
</ul>
<p><strong>kube-system</strong> (0 errors, 3 warnings):</p>
<ul>
<li class="">Pods: 3 in Warning (coredns high restart count)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="top-priority-issues">Top Priority Issues<a href="#top-priority-issues" class="hash-link" aria-label="Direct link to Top Priority Issues" title="Direct link to Top Priority Issues" translate="no">​</a></h3>
<ol>
<li class="">
<p><strong>production/api-server</strong> - CrashLoopBackOff (3 pods)
→ Needs immediate attention</p>
</li>
<li class="">
<p><strong>staging/database-migration</strong> - Job failed (2 pods)
→ Check migration logs</p>
</li>
<li class="">
<p><strong>monitoring/prometheus-server</strong> - High memory usage
→ May affect monitoring reliability</p>
</li>
<li class="">
<p><strong>kube-system/coredns</strong> - High restart count
→ Potential DNS issues</p>
</li>
</ol>
<p>Would you like me to investigate any of these in detail?</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**You**:</span><br></span></code></pre></div></div>
<p>Yes, investigate the coredns issue. It might be causing problems across namespaces.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Claude**:</span><br></span></code></pre></div></div>
<p>[Calling investigate tool for coredns pods]</p>
<p>CoreDNS Investigation:</p>
<p>Timeline (last hour):</p>
<p>[09:30] coredns-7d8b5f9c6b-x7k2p - Restart count: 0 → 3
Events: &quot;Liveness probe failed&quot; (3 times)</p>
<p>[09:45] coredns-7d8b5f9c6b-z9k3p - Restart count: 0 → 2
Events: &quot;Liveness probe failed&quot; (2 times)</p>
<p>Root Cause Indicators:</p>
<ul>
<li class="">High restart count (5 total across 2 pods in 30 minutes)</li>
<li class="">All failures are liveness probe failures</li>
<li class="">Coincides with increased DNS query rate (per events)</li>
</ul>
<p>Investigation Prompts:</p>
<ol>
<li class="">
<p>Why are the CoreDNS liveness probes failing?</p>
<ul>
<li class="">Check if DNS resolution is slow (timeout issues)</li>
<li class="">Review CoreDNS resource limits (CPU/memory constraints)</li>
</ul>
</li>
<li class="">
<p>Is this affecting other services?</p>
<ul>
<li class="">DNS failures would cause pod startup issues cluster-wide</li>
<li class="">May explain some of the errors in production/staging</li>
</ul>
</li>
</ol>
<p>Recommended Actions:</p>
<ol>
<li class="">
<p>Check CoreDNS resource usage:
kubectl top pods -n kube-system -l k8s-app=kube-dns</p>
</li>
<li class="">
<p>Review CoreDNS logs for errors:
kubectl logs -n kube-system -l k8s-app=kube-dns --tail=100</p>
</li>
<li class="">
<p>Increase CoreDNS resource limits if needed:
kubectl edit deployment coredns -n kube-system</p>
</li>
<li class="">
<p>Consider scaling CoreDNS replicas:
kubectl scale deployment coredns -n kube-system --replicas=3</p>
</li>
</ol>
<p>Note: DNS issues are cluster-wide and high priority!</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Example 6: Custom Resource Investigation (Flux GitRepository)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Scenario**: Your Flux GitRepository resource is failing, and you don&#x27;t know why.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Via Claude Desktop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**You**:</span><br></span></code></pre></div></div>
<p>Investigate the GitRepository resource flux-system/main-repo that&#x27;s been failing
for the last 2 hours</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Claude**:</span><br></span></code></pre></div></div>
<p>[Calling investigate tool for GitRepository/flux-system/main-repo]</p>
<p>GitRepository Investigation: flux-system/main-repo</p>
<p>Timeline (last 2 hours):</p>
<p>[08:15:00] Status: Ready
Revision: main@sha1<!-- -->:a3b4c5d6</p>
<p>[08:45:30] Status: Ready → Error
Event: &quot;Failed to checkout repository: authentication required&quot;
Revision: Failed to fetch</p>
<p>[09:00:15] Reconciliation attempts: 8 (all failed)
Event: &quot;SSH key authentication failed&quot;</p>
<p>[09:15:45] Status: Still Error
Event: &quot;Unable to clone: <a href="mailto:git@github.com" target="_blank" rel="noopener noreferrer" class="">git@github.com</a>:org<!-- -->/repo.git&quot;</p>
<p>Root Cause Analysis:</p>
<p>The GitRepository resource is failing to authenticate with GitHub
using SSH keys. This started at 08:45:30 and has persisted for
~1.5 hours.</p>
<p>Investigation Prompts:</p>
<ol>
<li class="">
<p>Why did SSH authentication suddenly fail?</p>
<ul>
<li class="">Was the SSH key rotated or revoked?</li>
<li class="">Did the GitHub repository change permissions?</li>
<li class="">Is the Secret containing SSH keys still present?</li>
</ul>
</li>
<li class="">
<p>Are other GitRepository resources affected?</p>
<ul>
<li class="">This may indicate a cluster-wide credential issue</li>
</ul>
</li>
</ol>
<p>Immediate Actions:</p>
<ol>
<li class="">
<p>Check if the Secret exists:
kubectl get secret flux-system-ssh -n flux-system</p>
</li>
<li class="">
<p>Verify Secret has correct SSH key:
kubectl get secret flux-system-ssh -n flux-system -o yaml | grep -A5 identity</p>
</li>
<li class="">
<p>Test Git access manually:
kubectl run debug-git --rm -it --image=alpine/git -- <br>
<!-- -->git ls-remote <a href="mailto:git@github.com" target="_blank" rel="noopener noreferrer" class="">git@github.com</a>:org<!-- -->/repo.git</p>
</li>
<li class="">
<p>If key is missing or expired, recreate Secret:
flux create secret git flux-system-ssh <br>
<!-- -->--url=ssh://git@github.com/org/repo.git <br>
<!-- -->--private-key-file=/path/to/new/key</p>
</li>
<li class="">
<p>Force reconciliation:
flux reconcile source git main-repo</p>
</li>
</ol>
<p>Expected Recovery: Immediate after Secret is fixed</p>
<p>Would you like me to check other GitRepository resources to see if this is
a widespread issue?</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Integration Patterns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Common ways to integrate MCP tools into workflows:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Pattern 1: Alert → Investigation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Trigger**: Prometheus/Alertmanager alert fires</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Workflow**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Alert notification includes namespace and resource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Operator asks Claude: &quot;Investigate &lt;resource&gt; in &lt;namespace&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Claude uses `investigate` tool to provide timeline and RCA prompts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Operator runs suggested kubectl commands</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. Issue is resolved or escalated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Example**:</span><br></span></code></pre></div></div>
<p>[PagerDuty Alert: High Pod Restart Rate - production/api-server]</p>
<p>You: Investigate deployment api-server in production namespace</p>
<p>Claude: [investigate tool]
Timeline shows image update 10 minutes ago...
[Provides immediate mitigation steps]</p>
<p>You: [Runs rollback command from Claude&#x27;s suggestion]</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Pattern 2: Incident → Post-Mortem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Trigger**: Incident is resolved, need documentation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Workflow**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Incident resolution completed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Operator asks Claude: &quot;Run post_mortem_incident_analysis from &lt;start&gt; to &lt;end&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Claude executes full post-mortem prompt workflow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Claude generates structured report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5. Report is saved to incident management system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Example**:</span><br></span></code></pre></div></div>
<p>[Incident resolved at 15:30]</p>
<p>You: Run post-mortem analysis from 14:00 to 15:30 in production</p>
<p>Claude: [post_mortem_incident_analysis prompt]
[Generates full report with timeline, RCA, recommendations]</p>
<p>You: [Copies report to Jira/GitHub/Confluence]</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Pattern 3: Maintenance Window Verification</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Trigger**: After deploying changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Workflow**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Deploy changes (deployment, configmap, etc.)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Ask Claude: &quot;Show me changes in the last 15 minutes&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Claude uses `resource_changes` to identify what actually changed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Verify expected changes occurred, no unexpected side effects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Example**:</span><br></span></code></pre></div></div>
<p>[Deployed v2.0 to production at 16:00]</p>
<p>You: Show high-impact changes in production in last 15 minutes</p>
<p>Claude: [resource_changes tool]
Deployment api-server updated: v1.9 → v2.0
ConfigMap api-config updated (expected)
HPA scaled 3 → 5 replicas (expected due to new load)</p>
<p>No unexpected errors detected.</p>
<p>You: Great, deployment looks clean!</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Pattern 4: Proactive Health Check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Trigger**: Daily/weekly routine check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Workflow**:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1. Operator asks Claude: &quot;Check cluster health for the last 24 hours&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Claude uses `cluster_health` to identify any warnings or errors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Operator addresses issues proactively before they become incidents</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Example**:</span><br></span></code></pre></div></div>
<p>[Monday morning routine]</p>
<p>You: Check cluster health across all namespaces for the last 24 hours</p>
<p>Claude: [cluster_health tool]
Overall: Healthy</p>
<p>Minor issues detected:</p>
<ul>
<li class="">staging/database: 1 pod in Warning (high memory usage)</li>
<li class="">monitoring/prometheus: 2 restarts (known issue, non-critical)</li>
</ul>
<p>No action required, but consider increasing database memory limits.</p>
<p>You: Noted, will increase memory in next maintenance window.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Claude Desktop Conversation Tips</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Be Specific with Time Windows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**❌ Vague**:</span><br></span></code></pre></div></div>
<p>Check for issues recently</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**✅ Specific**:</span><br></span></code></pre></div></div>
<p>Check cluster health in the production namespace for the last 30 minutes</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Provide Context</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**❌ Minimal**:</span><br></span></code></pre></div></div>
<p>Investigate pod api-server-x7k2p</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**✅ With Context**:</span><br></span></code></pre></div></div>
<p>Investigate pod api-server-x7k2p in production namespace.
We deployed a new version 15 minutes ago and it started failing.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Ask for Specific Tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**❌ Unclear**:</span><br></span></code></pre></div></div>
<p>Tell me what happened</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**✅ Tool-specific**:</span><br></span></code></pre></div></div>
<p>Use resource_changes to show me what changed in production in the last hour</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Follow Up with &quot;Why&quot; Questions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Good conversation flow**:</span><br></span></code></pre></div></div>
<p>You: Check production namespace health</p>
<p>Claude: [Shows 3 pods in error]</p>
<p>You: Why are those pods failing?</p>
<p>Claude: [Uses investigate tool]
They failed after a deployment update...</p>
<p>You: What was updated in the deployment?</p>
<p>Claude: [Shows configuration change details]</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Troubleshooting Common Scenarios</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Empty Results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Problem**: Tool returns no data or empty results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Cause**: Spectre may not have data for the requested time window</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Solution**:</span><br></span></code></pre></div></div>
<p>You: I&#x27;m getting empty results. Does Spectre have data for the last hour?</p>
<p>Claude: [Adjusts time window]
Let me check a longer time period...
[Calls cluster_health with 24-hour window]</p>
<p>I found data from 6 hours ago, but nothing in the last hour.
This suggests Spectre may not be actively indexing events.</p>
<p>Check if Spectre is running: kubectl get pods -n spectre-system</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Incomplete Analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Problem**: Claude&#x27;s analysis seems superficial</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Cause**: Need to dig deeper with multiple tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Solution**:</span><br></span></code></pre></div></div>
<p>You: That analysis seems incomplete. Can you investigate further?</p>
<p>Claude: You&#x27;re right. Let me use additional tools...
[Calls investigate tool for related resources]
[Calls resource_changes to find correlated events]
[Calls resource_explorer to find similar issues]</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### Claude Doesn&#x27;t Use Tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Problem**: Claude responds without calling MCP tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Cause**: Question wasn&#x27;t framed to trigger tool use</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**Solution**:</span><br></span></code></pre></div></div>
<p>❌ Bad: &quot;What might cause pods to fail?&quot;
(Claude gives generic answer without using tools)</p>
<p>✅ Good: &quot;Use cluster_health to check if any pods are currently failing&quot;
(Claude calls tool)</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Best Practices from Examples</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### ✅ Do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Start broad, then narrow**: Use `cluster_health` first, then `investigate` specific resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Specify namespaces**: Faster queries when scoped to one namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Use time windows**: &quot;Last 30 minutes&quot; is more efficient than &quot;last 7 days&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Follow Claude&#x27;s suggestions**: Run kubectl commands Claude recommends</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Chain investigations**: Use results from one tool to inform the next query</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Save post-mortem reports**: Copy Claude&#x27;s formatted reports to your docs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Verify with kubectl**: Always confirm Claude&#x27;s findings with live cluster state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">### ❌ Don&#x27;t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Don&#x27;t expect Claude to execute commands**: Claude suggests kubectl commands, you must run them</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Don&#x27;t ignore kubectl logs**: Spectre shows events, but container logs are still needed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Don&#x27;t query very old data**: Check Spectre retention period (default: 7 days)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Don&#x27;t rely solely on AI**: Use Claude as an assistant, not a replacement for expertise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Don&#x27;t skip follow-up**: Claude often says &quot;Would you like me to investigate X?&quot; - say yes!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- **Don&#x27;t ignore data gaps**: Claude will mention &quot;Additional investigation needed&quot; - follow up on those</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Related Documentation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [Getting Started with MCP](./getting-started.md) - Deploy and verify MCP integration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [Claude Desktop Integration](./claude-integration.md) - Set up Claude Desktop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [Tools Reference](./tools-reference/cluster-health.md) - Detailed API docs for all tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [Prompts Reference](./prompts-reference/post-mortem.md) - Workflow guides for prompts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- [MCP Configuration](../configuration/mcp-configuration.md) - Production configuration and tuning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!-- Source: Synthesized from tool and prompt documentation, README.md examples --&gt;</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/moolen/spectre/tree/master/docs/docs/mcp-integration/examples.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-12-13T08:58:49.000Z" itemprop="dateModified">Dec 13, 2025</time></b> by <b>Moritz Johner</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/spectre/docs/mcp-integration/claude-integration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Claude Desktop Integration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/spectre/docs/architecture/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Architecture</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#example-1-crashloopbackoff-investigation" class="table-of-contents__link toc-highlight">Example 1: CrashLoopBackOff Investigation</a><ul><li><a href="#via-claude-desktop" class="table-of-contents__link toc-highlight">Via Claude Desktop</a></li><li><a href="#via-http-api-programmatic" class="table-of-contents__link toc-highlight">Via HTTP API (Programmatic)</a></li></ul></li><li><a href="#example-2-post-mortem-analysis-complete-workflow" class="table-of-contents__link toc-highlight">Example 2: Post-Mortem Analysis (Complete Workflow)</a><ul><li><a href="#via-claude-desktop-1" class="table-of-contents__link toc-highlight">Via Claude Desktop</a></li><li><a href="#via-http-api" class="table-of-contents__link toc-highlight">Via HTTP API</a></li></ul></li><li><a href="#example-3-live-incident-handling" class="table-of-contents__link toc-highlight">Example 3: Live Incident Handling</a><ul><li><a href="#via-claude-desktop-2" class="table-of-contents__link toc-highlight">Via Claude Desktop</a></li><li><a href="#recommended-action" class="table-of-contents__link toc-highlight">Recommended Action</a></li><li><a href="#monitoring-for-recovery" class="table-of-contents__link toc-highlight">Monitoring for Recovery</a></li><li><a href="#follow-up-actions-after-recovery" class="table-of-contents__link toc-highlight">Follow-Up Actions (After Recovery)</a></li><li><a href="#additional-investigation-needed" class="table-of-contents__link toc-highlight">Additional Investigation Needed</a></li><li><a href="#changes-with-impact-score--05" class="table-of-contents__link toc-highlight">Changes with Impact Score &gt; 0.5</a></li><li><a href="#changes-with-impact-score-03-05" class="table-of-contents__link toc-highlight">Changes with Impact Score 0.3-0.5</a></li><li><a href="#correlation-analysis" class="table-of-contents__link toc-highlight">Correlation Analysis</a></li><li><a href="#overall-summary" class="table-of-contents__link toc-highlight">Overall Summary</a></li><li><a href="#issues-by-namespace" class="table-of-contents__link toc-highlight">Issues by Namespace</a></li><li><a href="#top-priority-issues" class="table-of-contents__link toc-highlight">Top Priority Issues</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/spectre/docs/intro">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/spectre/docs/installation">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/spectre/docs/mcp-integration">MCP Integration</a></li><li class="footer__item"><a class="footer__link-item" href="/spectre/docs/architecture">Architecture</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/spectre/docs/api">API Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/spectre/docs/operations/troubleshooting">Troubleshooting</a></li><li class="footer__item"><a href="https://github.com/moolen/spectre/tree/master/chart" target="_blank" rel="noopener noreferrer" class="footer__link-item">Helm Chart<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/moolen/spectre" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/moolen/spectre/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Issues<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/moolen/spectre/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussions<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Spectre Project. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>