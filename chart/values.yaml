nameOverride: ""
fullnameOverride: ""
namespace: monitoring

image:
  repository: spectre
  tag: latest
  pullPolicy: IfNotPresent
  pullSecrets: []

replicaCount: 1

updateStrategy:
  type: RollingUpdate
  rollingUpdate:
    maxUnavailable: 0
    maxSurge: 1

minReadySeconds: 0

revisionHistoryLimit: 5

resources:
  requests:
    memory: "128Mi"
    cpu: "100m"
  limits:
    memory: "512Mi"
    cpu: "500m"

# Service configuration
# Port allocation:
#   - 8080: HTTP REST API with gRPC-Web support (main service)
#   - 8082: MCP HTTP server (sidecar)
#   - 9999: pprof profiling endpoint
service:
  type: ClusterIP
  port: 8080
  targetPort: 8080
  annotations: {}
  labels: {}
  loadBalancerIP: ""
  loadBalancerSourceRanges: []
  externalTrafficPolicy: ""
  sessionAffinity: None
  sessionAffinityConfig: {}

# Pprof profiling configuration
pprof:
  enabled: false
  port: 9999

# OpenTelemetry tracing configuration
tracing:
  enabled: false
  endpoint: ""  # OTLP gRPC endpoint (e.g., "victorialogs:4317")

# MCP (Model Context Protocol) sidecar configuration
mcp:
  enabled: true
  spectreURL: "http://localhost:8080"  # Connect to main container via localhost (REST API)
  httpAddr: ":8082"
  port: 8082
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"
  securityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
    readOnlyRootFilesystem: false
    runAsNonRoot: true
    runAsUser: 1000
  livenessProbe:
    enabled: true
    httpGet:
      path: /health
      port: mcp
    initialDelaySeconds: 5
    periodSeconds: 10
    timeoutSeconds: 3
    failureThreshold: 3
    successThreshold: 1
  readinessProbe:
    enabled: true
    httpGet:
      path: /health
      port: mcp
    initialDelaySeconds: 3
    periodSeconds: 5
    timeoutSeconds: 2
    failureThreshold: 3
    successThreshold: 1

# Persistent storage configuration
persistence:
  enabled: true
  size: 10Gi
  mountPath: /data
  # storageClassName: "" # Use default storage class if not specified
  accessModes:
    - ReadWriteOnce
  annotations: {}
  selector: {}
  existingClaim: ""

config:
  logLevel: "info"
  segmentSize: 10485760  # 10MB in bytes
  maxConcurrentRequests: 100
  # Watcher configuration - resources to watch
  # Each resource specifies Group/Version/Kind and optional namespace
  watcher:
    resources:
      - group: ""
        version: "v1"
        kind: "Pod"
      - group: "apps"
        version: "v1"
        kind: "Deployment"
      - group: ""
        version: "v1"
        kind: "Service"
      - group: ""
        version: "v1"
        kind: "Node"
      - group: "apps"
        version: "v1"
        kind: "StatefulSet"
      - group: "apps"
        version: "v1"
        kind: "DaemonSet"
      - group: ""
        version: "v1"
        kind: "ConfigMap"

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: false
  runAsNonRoot: true
  runAsUser: 1000

livenessProbe:
  enabled: true
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3
  successThreshold: 1

readinessProbe:
  enabled: true
  httpGet:
    path: /ready
    port: http
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3
  successThreshold: 1

startupProbe:
  enabled: false
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 0
  periodSeconds: 10
  timeoutSeconds: 3
  failureThreshold: 30
  successThreshold: 1

podAnnotations: {}
podLabels: {}
priorityClassName: ""
terminationGracePeriodSeconds: 15
dnsPolicy: ClusterFirst
dnsConfig: {}
hostAliases: []
hostNetwork: false
hostPID: false
hostIPC: false
nodeSelector: {}
tolerations: []
affinity: {}
topologySpreadConstraints: []

serviceAccount:
  create: true
  name: ""  # Will use "spectre" if not specified
  annotations: {}
  automountServiceAccountToken: true

extraArgs: []

extraVolumes: []
extraVolumeMounts: []

env: []
envFrom: []
lifecycle: {}
ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: spectre.example.com
      paths:
        - path: /
          pathType: Prefix
  tls: []
  mcp:
    enabled: false
    host: mcp.spectre.example.com
    paths:
      - path: /
        pathType: Prefix
    tls: []

serviceMonitor:
  enabled: false
  namespace: ""
  labels: {}
  interval: 30s
  scrapeTimeout: 10s
  path: /metrics
  relabelings: []
  metricRelabelings: []

podDisruptionBudget:
  enabled: false
  minAvailable: 1
