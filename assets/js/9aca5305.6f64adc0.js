"use strict";(globalThis.webpackChunkspectre_docs=globalThis.webpackChunkspectre_docs||[]).push([[2112],{1085:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"mcp-integration/tools-reference/cluster-health","title":"cluster_health Tool","description":"Get cluster health overview with resource status breakdown and top issues","source":"@site/docs/mcp-integration/tools-reference/cluster-health.md","sourceDirName":"mcp-integration/tools-reference","slug":"/mcp-integration/tools-reference/cluster-health","permalink":"/spectre/docs/mcp-integration/tools-reference/cluster-health","draft":false,"unlisted":false,"editUrl":"https://github.com/moolen/spectre/tree/master/docs/docs/mcp-integration/tools-reference/cluster-health.md","tags":[],"version":"current","lastUpdatedBy":"Moritz Johner","lastUpdatedAt":1765616329000,"frontMatter":{"title":"cluster_health Tool","description":"Get cluster health overview with resource status breakdown and top issues","keywords":["mcp","tools","kubernetes","health","monitoring","status"]},"sidebar":"docsSidebar","previous":{"title":"Getting Started with MCP","permalink":"/spectre/docs/mcp-integration/getting-started"},"next":{"title":"resource_changes Tool","permalink":"/spectre/docs/mcp-integration/tools-reference/resource-changes"}}');var t=n(4848),i=n(8453);const c={title:"cluster_health Tool",description:"Get cluster health overview with resource status breakdown and top issues",keywords:["mcp","tools","kubernetes","health","monitoring","status"]},l="cluster_health",d={},o=[{value:"Overview",id:"overview",level:2},{value:"Purpose",id:"purpose",level:3},{value:"Use Cases",id:"use-cases",level:3},{value:"Typical Users",id:"typical-users",level:3},{value:"Quick Example",id:"quick-example",level:2},{value:"Simple Query",id:"simple-query",level:3},{value:"Typical Use Case",id:"typical-use-case",level:3},{value:"Input Parameters",id:"input-parameters",level:2},{value:"Required Parameters",id:"required-parameters",level:3},{value:"Optional Parameters",id:"optional-parameters",level:3},{value:"Output Structure",id:"output-structure",level:2},{value:"Response Format",id:"response-format",level:3},{value:"Field Descriptions",id:"field-descriptions",level:3},{value:"Top-Level Fields",id:"top-level-fields",level:4},{value:"ResourceStatusCount Object",id:"resourcestatuscount-object",level:4},{value:"Issue Object",id:"issue-object",level:4},{value:"Status Values",id:"status-values",level:3},{value:"Usage Patterns",id:"usage-patterns",level:2},{value:"Pattern 1: Cluster-Wide Health Check",id:"pattern-1-cluster-wide-health-check",level:3},{value:"Pattern 2: Namespace-Specific Investigation",id:"pattern-2-namespace-specific-investigation",level:3},{value:"Pattern 3: Recent Health Assessment",id:"pattern-3-recent-health-assessment",level:3},{value:"Pattern 4: Historical Analysis",id:"pattern-4-historical-analysis",level:3},{value:"Real-World Examples",id:"real-world-examples",level:2},{value:"Example 1: Detecting Pod Issues",id:"example-1-detecting-pod-issues",level:3},{value:"Example 2: All-Clear Health Check",id:"example-2-all-clear-health-check",level:3},{value:"Performance Characteristics",id:"performance-characteristics",level:2},{value:"Execution Time",id:"execution-time",level:3},{value:"Optimization Tips",id:"optimization-tips",level:3},{value:"Resource Impact",id:"resource-impact",level:3},{value:"Integration Patterns",id:"integration-patterns",level:2},{value:"With Other Tools",id:"with-other-tools",level:3},{value:"With Prompts",id:"with-prompts",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Errors",id:"common-errors",level:3},{value:"Empty Results",id:"empty-results",level:3},{value:"Performance Issues",id:"performance-issues",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"MCP Protocol Request",id:"mcp-protocol-request",level:3},{value:"cURL Example",id:"curl-example",level:3},{value:"Claude Desktop Example",id:"claude-desktop-example",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 Do",id:"-do",level:3},{value:"\u274c Don&#39;t",id:"-dont",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function a(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"cluster_health",children:"cluster_health"})}),"\n",(0,t.jsx)(s.p,{children:"Get a comprehensive health overview of your Kubernetes cluster with resource status breakdowns and prioritized issue identification."}),"\n",(0,t.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(s.h3,{id:"purpose",children:"Purpose"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"cluster_health"})," tool provides a high-level assessment of cluster health during a specific time window. It aggregates resource statuses by kind, identifies resources in error or warning states, and highlights the most critical issues sorted by error duration."]}),"\n",(0,t.jsx)(s.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Scenario"}),(0,t.jsx)(s.th,{children:"When to Use"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Initial Triage"})}),(0,t.jsx)(s.td,{children:"Start of incident investigation to identify scope of impact"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Health Checks"})}),(0,t.jsx)(s.td,{children:"Regular monitoring or post-deployment verification"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Post-Mortem"})}),(0,t.jsx)(s.td,{children:"Historical health assessment during incident windows"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Scoping Analysis"})}),(0,t.jsx)(s.td,{children:"Determine which namespaces or resource types are affected"})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"typical-users",children:"Typical Users"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"AI Agents"}),": Initial step in automated incident investigation workflows"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Operators"}),": Quick cluster health assessment during incidents"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"SREs"}),": Regular health checks and monitoring"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"quick-example",children:"Quick Example"}),"\n",(0,t.jsx)(s.h3,{id:"simple-query",children:"Simple Query"}),"\n",(0,t.jsx)(s.p,{children:"Get cluster health for the last hour:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "start_time": 1702393800,\n  "end_time": 1702397400\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"What this does"}),": Analyzes all resources across all namespaces in the last hour, returning status counts by kind and top 10 issues."]}),"\n",(0,t.jsx)(s.h3,{id:"typical-use-case",children:"Typical Use Case"}),"\n",(0,t.jsx)(s.p,{children:"During an incident, narrow down to a specific namespace:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "start_time": 1702393800,\n  "end_time": 1702397400,\n  "namespace": "production",\n  "max_resources": 50\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Result"}),": Focused view of production namespace health with top 50 problem resources per status."]}),"\n",(0,t.jsx)(s.h2,{id:"input-parameters",children:"Input Parameters"}),"\n",(0,t.jsx)(s.h3,{id:"required-parameters",children:"Required Parameters"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"}),(0,t.jsx)(s.th,{children:"Example"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"start_time"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Start timestamp (Unix seconds or milliseconds)"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"1702393800"})," or ",(0,t.jsx)(s.code,{children:"1702393800000"})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"end_time"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"End timestamp (Unix seconds or milliseconds)"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"1702397400"})," or ",(0,t.jsx)(s.code,{children:"1702397400000"})]})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Timestamp Format"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Accepts both Unix seconds (10 digits) and milliseconds (13 digits)"}),"\n",(0,t.jsx)(s.li,{children:"Automatically detects and converts milliseconds to seconds"}),"\n",(0,t.jsxs)(s.li,{children:["Must satisfy: ",(0,t.jsx)(s.code,{children:"start_time < end_time"})]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"optional-parameters",children:"Optional Parameters"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Default"}),(0,t.jsx)(s.th,{children:"Description"}),(0,t.jsx)(s.th,{children:"Example"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"namespace"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:'""'})," (all namespaces)"]}),(0,t.jsx)(s.td,{children:"Filter by Kubernetes namespace"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:'"production"'})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"max_resources"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"100"})}),(0,t.jsx)(s.td,{children:"Max resources to list per status (max: 500)"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"50"})})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Parameter Notes"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"namespace"}),": If omitted, queries all namespaces cluster-wide"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"max_resources"}),": Controls size of ",(0,t.jsx)(s.code,{children:"error_resources"}),", ",(0,t.jsx)(s.code,{children:"warning_resources"})," etc. lists. Higher values increase response size."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"output-structure",children:"Output Structure"}),"\n",(0,t.jsx)(s.h3,{id:"response-format",children:"Response Format"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "overall_status": "Degraded",\n  "total_resources": 245,\n  "error_resource_count": 3,\n  "warning_resource_count": 12,\n  "healthy_resource_count": 230,\n  "resources_by_kind": [\n    {\n      "kind": "Pod",\n      "ready": 185,\n      "warning": 8,\n      "error": 2,\n      "terminating": 1,\n      "unknown": 0,\n      "total_count": 196,\n      "error_rate": 0.051,\n      "warning_resources": ["production/api-gateway-abc", "production/worker-xyz"],\n      "error_resources": ["production/payment-processor-123", "staging/data-import-456"]\n    },\n    {\n      "kind": "Deployment",\n      "ready": 42,\n      "warning": 3,\n      "error": 1,\n      "total_count": 46,\n      "error_rate": 0.087,\n      "error_resources": ["production/payment-api"]\n    }\n  ],\n  "top_issues": [\n    {\n      "resource_id": "pod-789",\n      "kind": "Pod",\n      "namespace": "production",\n      "name": "payment-processor-abc",\n      "current_status": "Error",\n      "error_duration_seconds": 3600,\n      "error_duration_text": "1h 0m 0s",\n      "error_message": "ImagePullBackOff",\n      "event_count": 15\n    }\n  ],\n  "aggregation_time_ms": 145\n}\n'})}),"\n",(0,t.jsx)(s.h3,{id:"field-descriptions",children:"Field Descriptions"}),"\n",(0,t.jsx)(s.h4,{id:"top-level-fields",children:"Top-Level Fields"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Field"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"overall_status"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsxs)(s.td,{children:["Cluster-wide status: ",(0,t.jsx)(s.code,{children:'"Healthy"'}),", ",(0,t.jsx)(s.code,{children:'"Degraded"'}),", ",(0,t.jsx)(s.code,{children:'"Critical"'})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"total_resources"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Total number of resources analyzed"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"error_resource_count"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Count of resources in Error status"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"warning_resource_count"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Count of resources in Warning status"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"healthy_resource_count"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Count of resources in Ready status"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"resources_by_kind"})}),(0,t.jsx)(s.td,{children:"array"}),(0,t.jsx)(s.td,{children:"Status breakdown by resource kind (sorted alphabetically)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"top_issues"})}),(0,t.jsx)(s.td,{children:"array"}),(0,t.jsx)(s.td,{children:"Top 10 issues sorted by error duration (descending)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"aggregation_time_ms"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Query execution time in milliseconds"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"resourcestatuscount-object",children:"ResourceStatusCount Object"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Field"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"kind"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:'Resource kind (e.g., "Pod", "Deployment")'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"ready"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Count of resources in Ready status"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"warning"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Count of resources in Warning status"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"error"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Count of resources in Error status"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"terminating"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Count of resources being terminated"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"unknown"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Count of resources with Unknown status"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"total_count"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Sum of all status counts for this kind"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"error_rate"})}),(0,t.jsx)(s.td,{children:"float"}),(0,t.jsx)(s.td,{children:"Ratio of (error + warning) / total_count"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"warning_resources"})}),(0,t.jsx)(s.td,{children:"array of strings"}),(0,t.jsxs)(s.td,{children:["List of warning resources (format: ",(0,t.jsx)(s.code,{children:"namespace/name"}),")"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"error_resources"})}),(0,t.jsx)(s.td,{children:"array of strings"}),(0,t.jsxs)(s.td,{children:["List of error resources (format: ",(0,t.jsx)(s.code,{children:"namespace/name"}),")"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"terminating_resources"})}),(0,t.jsx)(s.td,{children:"array of strings"}),(0,t.jsx)(s.td,{children:"List of terminating resources"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"unknown_resources"})}),(0,t.jsx)(s.td,{children:"array of strings"}),(0,t.jsx)(s.td,{children:"List of unknown status resources"})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Note"}),": Resource lists are truncated to ",(0,t.jsx)(s.code,{children:"max_resources"})," parameter (default 100)."]}),"\n",(0,t.jsx)(s.h4,{id:"issue-object",children:"Issue Object"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Field"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"resource_id"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Unique resource identifier"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"kind"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Resource kind"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"namespace"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Kubernetes namespace"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"name"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Resource name"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"current_status"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:'Current status: "Error", "Warning", "Terminating", "Unknown"'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"error_duration_seconds"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Time spent in error/warning state (seconds)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"error_duration_text"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:'Human-readable duration (e.g., "2h 30m 15s")'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"error_message"})}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Current error or warning message"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"event_count"})}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{children:"Number of events associated with this resource"})]})]})]}),"\n",(0,t.jsx)(s.h3,{id:"status-values",children:"Status Values"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Status"}),(0,t.jsx)(s.th,{children:"Description"}),(0,t.jsx)(s.th,{children:"Included in Overall Status Calculation"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"Ready"})}),(0,t.jsx)(s.td,{children:"Resource is healthy and functioning"}),(0,t.jsx)(s.td,{children:'\u2705 Counts toward "Healthy"'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"Warning"})}),(0,t.jsx)(s.td,{children:"Resource has non-critical issues"}),(0,t.jsx)(s.td,{children:'\u26a0\ufe0f Triggers "Degraded" overall status'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"Error"})}),(0,t.jsx)(s.td,{children:"Resource has critical failures"}),(0,t.jsx)(s.td,{children:'\u274c Triggers "Critical" overall status'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"Terminating"})}),(0,t.jsx)(s.td,{children:"Resource is being deleted"}),(0,t.jsx)(s.td,{children:"\u2139\ufe0f Not counted in overall status"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"Unknown"})}),(0,t.jsx)(s.td,{children:"Resource status cannot be determined"}),(0,t.jsx)(s.td,{children:"\u2139\ufe0f Not counted in overall status"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"usage-patterns",children:"Usage Patterns"}),"\n",(0,t.jsx)(s.h3,{id:"pattern-1-cluster-wide-health-check",children:"Pattern 1: Cluster-Wide Health Check"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Scenario"}),": Regular health monitoring across entire cluster"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "start_time": 1702393800,\n  "end_time": 1702397400\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Expected Output"}),": All namespaces, all resource kinds, comprehensive overview"]}),"\n",(0,t.jsx)(s.h3,{id:"pattern-2-namespace-specific-investigation",children:"Pattern 2: Namespace-Specific Investigation"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Scenario"}),": Incident affecting specific namespace"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "start_time": 1702393800,\n  "end_time": 1702397400,\n  "namespace": "production"\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Expected Output"}),": Focused view of production namespace only"]}),"\n",(0,t.jsx)(s.h3,{id:"pattern-3-recent-health-assessment",children:"Pattern 3: Recent Health Assessment"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Scenario"}),": Check current cluster state (last 15 minutes)"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "start_time": 1702396500,  // 15 minutes ago\n  "end_time": 1702397400     // now\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Expected Output"}),": Near real-time cluster health snapshot"]}),"\n",(0,t.jsx)(s.h3,{id:"pattern-4-historical-analysis",children:"Pattern 4: Historical Analysis"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Scenario"}),": Post-mortem analysis of incident window"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "start_time": 1702300800,  // 3pm yesterday\n  "end_time": 1702304400     // 4pm yesterday\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Expected Output"}),": Historical health state during known incident"]}),"\n",(0,t.jsx)(s.h2,{id:"real-world-examples",children:"Real-World Examples"}),"\n",(0,t.jsx)(s.h3,{id:"example-1-detecting-pod-issues",children:"Example 1: Detecting Pod Issues"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Request"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "start_time": 1702393800,\n  "end_time": 1702397400,\n  "namespace": "production",\n  "max_resources": 100\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Response"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "overall_status": "Critical",\n  "total_resources": 187,\n  "error_resource_count": 5,\n  "warning_resource_count": 8,\n  "healthy_resource_count": 174,\n  "resources_by_kind": [\n    {\n      "kind": "Pod",\n      "ready": 145,\n      "warning": 6,\n      "error": 4,\n      "terminating": 2,\n      "total_count": 157,\n      "error_rate": 0.064,\n      "warning_resources": [\n        "production/api-gateway-7d9f8b-abc",\n        "production/worker-queue-45abc-xyz"\n      ],\n      "error_resources": [\n        "production/payment-processor-123",\n        "production/payment-processor-456",\n        "production/cache-redis-789",\n        "production/database-primary-012"\n      ],\n      "terminating_resources": [\n        "production/old-deployment-abc",\n        "production/old-deployment-xyz"\n      ]\n    },\n    {\n      "kind": "Deployment",\n      "ready": 27,\n      "warning": 2,\n      "error": 1,\n      "total_count": 30,\n      "error_rate": 0.1,\n      "error_resources": ["production/payment-api"]\n    }\n  ],\n  "top_issues": [\n    {\n      "resource_id": "pod-payment-123",\n      "kind": "Pod",\n      "namespace": "production",\n      "name": "payment-processor-123",\n      "current_status": "Error",\n      "error_duration_seconds": 1800,\n      "error_duration_text": "30m 0s",\n      "error_message": "CrashLoopBackOff: container exited with code 1",\n      "event_count": 25\n    },\n    {\n      "resource_id": "pod-cache-789",\n      "kind": "Pod",\n      "namespace": "production",\n      "name": "cache-redis-789",\n      "current_status": "Error",\n      "error_duration_seconds": 900,\n      "error_duration_text": "15m 0s",\n      "error_message": "Insufficient memory",\n      "event_count": 12\n    }\n  ],\n  "aggregation_time_ms": 156\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Analysis"}),": 5 critical errors in production, primarily Pods. Payment processor has been failing for 30 minutes."]}),"\n",(0,t.jsx)(s.h3,{id:"example-2-all-clear-health-check",children:"Example 2: All-Clear Health Check"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Request"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "start_time": 1702393800,\n  "end_time": 1702397400\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Response"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "overall_status": "Healthy",\n  "total_resources": 342,\n  "error_resource_count": 0,\n  "warning_resource_count": 0,\n  "healthy_resource_count": 342,\n  "resources_by_kind": [\n    {\n      "kind": "Deployment",\n      "ready": 58,\n      "warning": 0,\n      "error": 0,\n      "total_count": 58,\n      "error_rate": 0.0\n    },\n    {\n      "kind": "Pod",\n      "ready": 234,\n      "warning": 0,\n      "error": 0,\n      "total_count": 234,\n      "error_rate": 0.0\n    },\n    {\n      "kind": "Service",\n      "ready": 50,\n      "warning": 0,\n      "error": 0,\n      "total_count": 50,\n      "error_rate": 0.0\n    }\n  ],\n  "top_issues": [],\n  "aggregation_time_ms": 98\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Analysis"}),": Cluster is healthy, no issues detected."]}),"\n",(0,t.jsx)(s.h2,{id:"performance-characteristics",children:"Performance Characteristics"}),"\n",(0,t.jsx)(s.h3,{id:"execution-time",children:"Execution Time"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Cluster Size"}),(0,t.jsx)(s.th,{children:"Resources"}),(0,t.jsx)(s.th,{children:"Typical Latency"}),(0,t.jsx)(s.th,{children:"Notes"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Small (< 100 resources)"}),(0,t.jsx)(s.td,{children:"50-100"}),(0,t.jsx)(s.td,{children:"50-100 ms"}),(0,t.jsx)(s.td,{children:"Single namespace queries"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Medium (100-500 resources)"}),(0,t.jsx)(s.td,{children:"200-400"}),(0,t.jsx)(s.td,{children:"100-200 ms"}),(0,t.jsx)(s.td,{children:"Multi-namespace, filtered"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Large (500-2000 resources)"}),(0,t.jsx)(s.td,{children:"1000-1500"}),(0,t.jsx)(s.td,{children:"200-400 ms"}),(0,t.jsx)(s.td,{children:"Cluster-wide queries"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Very Large (2000+ resources)"}),(0,t.jsx)(s.td,{children:"2000+"}),(0,t.jsx)(s.td,{children:"400-800 ms"}),(0,t.jsx)(s.td,{children:"Full cluster, wide time ranges"})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Factors Affecting Performance"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Time range width (wider = more events to process)"}),"\n",(0,t.jsx)(s.li,{children:"Number of namespaces queried"}),"\n",(0,t.jsx)(s.li,{children:"Spectre API response time"}),"\n",(0,t.jsx)(s.li,{children:"Number of resources with status changes"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"optimization-tips",children:"Optimization Tips"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"\u2705 Improve Performance"}),":"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Narrow time window"}),": Query last 1 hour instead of last 24 hours"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Filter by namespace"}),": Reduce scope to specific namespaces"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Limit max_resources"}),": Use lower values (10-50) if you don't need full lists"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Cache results"}),": For dashboards, cache responses for 30-60 seconds"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"\u274c Avoid"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Very wide time ranges (> 7 days) without namespace filtering"}),"\n",(0,t.jsx)(s.li,{children:"Querying all namespaces when you only need one"}),"\n",(0,t.jsx)(s.li,{children:"Setting max_resources unnecessarily high (> 200)"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"resource-impact",children:"Resource Impact"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Memory"}),": ~5-10 MB per request (scales with result set size)\n",(0,t.jsx)(s.strong,{children:"CPU"}),": Minimal (mostly I/O waiting for Spectre API)\n",(0,t.jsx)(s.strong,{children:"Network"}),": Proportional to number of resources returned"]}),"\n",(0,t.jsx)(s.h2,{id:"integration-patterns",children:"Integration Patterns"}),"\n",(0,t.jsx)(s.h3,{id:"with-other-tools",children:"With Other Tools"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Typical Investigation Workflow"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"1. cluster_health (this tool)\n   \u2193 Identifies: 5 Pods in Error state in production\n\n2. resource_changes\n   \u2193 Discovers: Deployment updated 15 minutes ago\n\n3. investigate (specific Pod)\n   \u2193 Analyzes: Timeline of Pod failures, root cause evidence\n"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"When to Use Each"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"cluster_health"}),": Start here for overview, identify problem areas"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"resource_changes"}),": Investigate what changed to cause issues"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"investigate"}),": Deep dive into specific resources identified by cluster_health"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"with-prompts",children:"With Prompts"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Used by These Prompts"}),":"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"post_mortem_incident_analysis"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Step 2: Calls cluster_health to get incident window overview"}),"\n",(0,t.jsxs)(s.li,{children:["Uses ",(0,t.jsx)(s.code,{children:"overall_status"})," and ",(0,t.jsx)(s.code,{children:"top_issues"})," to identify scope"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"live_incident_handling"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Step 2: Calls cluster_health for current state assessment"}),"\n",(0,t.jsxs)(s.li,{children:["Focuses on ",(0,t.jsx)(s.code,{children:"error_resources"})," and ",(0,t.jsx)(s.code,{children:"top_issues"})," for triage"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Prompt Interpretation"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:'overall_status = "Critical"'})," \u2192 Prompts investigate top_issues immediately"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:'overall_status = "Degraded"'})," \u2192 Prompts ask if investigation needed"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:'overall_status = "Healthy"'})," \u2192 Prompts look elsewhere for root cause"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(s.h3,{id:"common-errors",children:"Common Errors"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:'Error: "start_time must be before end_time"'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Cause"}),": Invalid time range"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Solution"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'// \u274c Wrong\n{\n  "start_time": 1702397400,\n  "end_time": 1702393800\n}\n\n// \u2705 Correct\n{\n  "start_time": 1702393800,\n  "end_time": 1702397400\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:'Error: "failed to query timeline: connection refused"'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Cause"}),": MCP server cannot reach Spectre API"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Solution"}),": Check Spectre API is running and accessible from MCP server"]}),"\n",(0,t.jsx)(s.h3,{id:"empty-results",children:"Empty Results"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Symptom"}),": ",(0,t.jsx)(s.code,{children:"total_resources: 0"}),", empty ",(0,t.jsx)(s.code,{children:"resources_by_kind"})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Possible Causes"}),":"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"No events in time range"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Spectre hasn't collected events yet"}),"\n",(0,t.jsx)(s.li,{children:"Time range outside Spectre retention"}),"\n",(0,t.jsx)(s.li,{children:"Solution: Verify Spectre is collecting events, adjust time range"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Namespace doesn't exist"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Querying non-existent namespace"}),"\n",(0,t.jsx)(s.li,{children:"Solution: Check namespace spelling, omit namespace parameter"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Time format issue"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Using milliseconds for both timestamps"}),"\n",(0,t.jsx)(s.li,{children:"Solution: Tool auto-converts, but verify timestamps are valid Unix times"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"performance-issues",children:"Performance Issues"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Symptom"}),": ",(0,t.jsx)(s.code,{children:"aggregation_time_ms > 1000"})," (slow queries)"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Causes & Solutions"}),":"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Cause"}),(0,t.jsx)(s.th,{children:"Symptom"}),(0,t.jsx)(s.th,{children:"Solution"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Wide time range"}),(0,t.jsx)(s.td,{children:"High aggregation_time_ms"}),(0,t.jsx)(s.td,{children:"Narrow to last 1-6 hours"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Cluster-wide query"}),(0,t.jsx)(s.td,{children:"Many resources"}),(0,t.jsx)(s.td,{children:"Add namespace filter"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Spectre API slow"}),(0,t.jsx)(s.td,{children:"Check Spectre logs"}),(0,t.jsx)(s.td,{children:"Optimize Spectre storage/cache"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"High max_resources"}),(0,t.jsx)(s.td,{children:"Large response payload"}),(0,t.jsx)(s.td,{children:"Reduce to 50-100"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,t.jsx)(s.h3,{id:"mcp-protocol-request",children:"MCP Protocol Request"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Initialize Session"})," (first):"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "id": 1,\n  "method": "initialize",\n  "params": {\n    "protocolVersion": "2024-11-05",\n    "capabilities": {},\n    "clientInfo": {\n      "name": "my-client",\n      "version": "1.0.0"\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Call cluster_health Tool"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "id": 2,\n  "method": "tools/call",\n  "params": {\n    "name": "cluster_health",\n    "arguments": {\n      "start_time": 1702393800,\n      "end_time": 1702397400,\n      "namespace": "production",\n      "max_resources": 100\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(s.h3,{id:"curl-example",children:"cURL Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'# Via HTTP transport\ncurl -X POST http://spectre-mcp:8081/mcp \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "jsonrpc": "2.0",\n    "id": 2,\n    "method": "tools/call",\n    "params": {\n      "name": "cluster_health",\n      "arguments": {\n        "start_time": 1702393800,\n        "end_time": 1702397400,\n        "namespace": "production"\n      }\n    }\n  }\'\n'})}),"\n",(0,t.jsx)(s.h3,{id:"claude-desktop-example",children:"Claude Desktop Example"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Natural Language"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'"What\'s the health status of the production namespace in the last hour?"\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Claude's Tool Call"})," (automatic):"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "name": "cluster_health",\n  "arguments": {\n    "start_time": 1702393800,\n    "end_time": 1702397400,\n    "namespace": "production"\n  }\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Claude's Response"}),":"]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"Based on the cluster health check for production in the last hour:"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Overall Status"}),": Critical"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Summary"}),":"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Total Resources: 187"}),"\n",(0,t.jsx)(s.li,{children:"Errors: 5 resources"}),"\n",(0,t.jsx)(s.li,{children:"Warnings: 8 resources"}),"\n",(0,t.jsx)(s.li,{children:"Healthy: 174 resources"}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Top Issues"}),":"]}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Pod ",(0,t.jsx)(s.code,{children:"payment-processor-123"})," in Error state for 30 minutes (CrashLoopBackOff)"]}),"\n",(0,t.jsxs)(s.li,{children:["Pod ",(0,t.jsx)(s.code,{children:"cache-redis-789"})," in Error state for 15 minutes (Insufficient memory)"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Recommendation"}),": Investigate the payment-processor first as it has the longest error duration."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(s.h3,{id:"-do",children:"\u2705 Do"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Start with cluster_health"})," for any investigation - it provides essential context"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Use specific time windows"})," - query the exact incident window when known"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Filter by namespace"})," when investigating specific service issues"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Check overall_status"})," first to understand severity"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Review top_issues"})," to prioritize which resources need investigation"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Use max_resources wisely"})," - lower values (10-50) for quick checks, higher (100-200) for comprehensive lists"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"-dont",children:"\u274c Don't"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Don't query excessive time ranges"})," (> 7 days) without namespace filtering"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Don't ignore aggregation_time_ms"})," - high values indicate performance issues"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Don't assume empty results mean no issues"})," - check Spectre is collecting data"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Don't set max_resources > 500"})," - it's capped at 500 anyway"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Don't use cluster_health alone"})," - combine with resource_changes and investigate for full picture"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Don't query all namespaces"})," if you already know which namespace is affected"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"./resource-changes",children:"resource_changes Tool"})," - Identify what changed during incidents"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"./investigate",children:"investigate Tool"})," - Deep dive into specific resources"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"./resource-explorer",children:"resource_explorer Tool"})," - Browse and discover resources"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../prompts-reference/post-mortem",children:"Post-Mortem Prompt"})," - Uses cluster_health as step 2"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../prompts-reference/live-incident",children:"Live Incident Prompt"})," - Uses cluster_health for triage"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../getting-started",children:"Getting Started"})," - Setup and first investigation"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>l});var r=n(6540);const t={},i=r.createContext(t);function c(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);