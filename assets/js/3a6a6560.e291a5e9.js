"use strict";(globalThis.webpackChunkspectre_docs=globalThis.webpackChunkspectre_docs||[]).push([[9333],{4589:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"mcp-integration/prompts-reference/live-incident","title":"live_incident_handling Prompt","description":"Real-time incident triage and immediate mitigation guidance","source":"@site/docs/mcp-integration/prompts-reference/live-incident.md","sourceDirName":"mcp-integration/prompts-reference","slug":"/mcp-integration/prompts-reference/live-incident","permalink":"/spectre/docs/mcp-integration/prompts-reference/live-incident","draft":false,"unlisted":false,"editUrl":"https://github.com/moolen/spectre/tree/master/docs/docs/mcp-integration/prompts-reference/live-incident.md","tags":[],"version":"current","lastUpdatedBy":"Moritz Johner","lastUpdatedAt":1765616329000,"frontMatter":{"title":"live_incident_handling Prompt","description":"Real-time incident triage and immediate mitigation guidance","keywords":["mcp","prompts","live-incident","triage","mitigation","troubleshooting"]},"sidebar":"docsSidebar","previous":{"title":"post_mortem_incident_analysis Prompt","permalink":"/spectre/docs/mcp-integration/prompts-reference/post-mortem"},"next":{"title":"Claude Desktop Integration","permalink":"/spectre/docs/mcp-integration/claude-integration"}}');var t=i(4848),r=i(8453);const o={title:"live_incident_handling Prompt",description:"Real-time incident triage and immediate mitigation guidance",keywords:["mcp","prompts","live-incident","triage","mitigation","troubleshooting"]},l="live_incident_handling Prompt",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Arguments",id:"arguments",level:2},{value:"Timestamp Format",id:"timestamp-format",level:3},{value:"Incident Window Calculation",id:"incident-window-calculation",level:3},{value:"Workflow",id:"workflow",level:2},{value:"Step 1: Confirm Parameters &amp; Calculate Window",id:"step-1-confirm-parameters--calculate-window",level:3},{value:"Step 2: Identify Critical Resources",id:"step-2-identify-critical-resources",level:3},{value:"Step 3: Identify Recent Changes",id:"step-3-identify-recent-changes",level:3},{value:"Step 4: Investigate Failing Resources",id:"step-4-investigate-failing-resources",level:3},{value:"Step 5: Correlate Events to Root Cause",id:"step-5-correlate-events-to-root-cause",level:3},{value:"Step 6: Recommend Immediate Mitigation",id:"step-6-recommend-immediate-mitigation",level:3},{value:"Step 7: Suggest Monitoring &amp; Follow-Up",id:"step-7-suggest-monitoring--follow-up",level:3},{value:"Step 8: List Additional Data Needed",id:"step-8-list-additional-data-needed",level:3},{value:"Key Features",id:"key-features",level:2},{value:"1. Focus on Recent Data",id:"1-focus-on-recent-data",level:3},{value:"2. Immediate Actions",id:"2-immediate-actions",level:3},{value:"3. Acknowledges Uncertainty",id:"3-acknowledges-uncertainty",level:3},{value:"4. No Hallucinations",id:"4-no-hallucinations",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Example 1: Via Claude Desktop (Natural Language)",id:"example-1-via-claude-desktop-natural-language",level:3},{value:"Example 2: Via MCP API",id:"example-2-via-mcp-api",level:3},{value:"Example 3: Resource Quota Issue",id:"example-3-resource-quota-issue",level:3},{value:"Integration with Tools",id:"integration-with-tools",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 Do",id:"-do",level:3},{value:"\u274c Don&#39;t",id:"-dont",level:3},{value:"Limitations",id:"limitations",level:2},{value:"1. Real-Time Data Only",id:"1-real-time-data-only",level:3},{value:"2. No Container Logs",id:"2-no-container-logs",level:3},{value:"3. No External Metrics",id:"3-no-external-metrics",level:3},{value:"4. Hypothesis vs. Fact",id:"4-hypothesis-vs-fact",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"live_incident_handling-prompt",children:"live_incident_handling Prompt"})}),"\n",(0,t.jsx)(n.p,{children:"Real-time incident triage and investigation with immediate mitigation guidance for ongoing issues."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"live_incident_handling"})," prompt guides an LLM through immediate incident response, focusing on quick triage, root cause identification, and actionable mitigation steps."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key Capabilities:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Real-Time Focus"}),": Analyzes recent events (looks before incident start for precursors)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Immediate Mitigation"}),": Concrete action steps (restart, rollback, scale)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Fast Triage"}),": 8-step workflow optimized for speed"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"No Hallucinations"}),": Only reports actual tool results"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Log Guidance"}),": Specific kubectl commands for verification"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Acknowledges Uncertainty"}),": Marks hypotheses when data is incomplete"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Monitoring Suggestions"}),": What to watch for escalation or recovery"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Active incident troubleshooting"}),"\n",(0,t.jsx)(n.li,{children:"Service degradation or outage in progress"}),"\n",(0,t.jsx)(n.li,{children:"Pods crashing or failing to start"}),"\n",(0,t.jsx)(n.li,{children:"Deployment or rollout issues"}),"\n",(0,t.jsx)(n.li,{children:"Resource quota or capacity problems"}),"\n",(0,t.jsx)(n.li,{children:"Real-time triage before full post-mortem"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"When NOT to Use:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Historical incident analysis (use ",(0,t.jsx)(n.code,{children:"post_mortem_incident_analysis"})," instead)"]}),"\n",(0,t.jsxs)(n.li,{children:["Routine health checks (use ",(0,t.jsx)(n.code,{children:"cluster_health"})," tool directly)"]}),"\n",(0,t.jsx)(n.li,{children:"Proactive monitoring (use external monitoring tools)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"arguments",children:"Arguments"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Argument"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Required"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"incident_start_time"})}),(0,t.jsx)(n.td,{children:"int64"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Yes"})}),(0,t.jsx)(n.td,{children:"When symptoms first appeared (Unix timestamp in seconds or milliseconds)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"current_time"})}),(0,t.jsx)(n.td,{children:"int64"}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:"Current time (Unix timestamp); defaults to now if omitted"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"namespace"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:"Kubernetes namespace to focus on (optional)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"symptoms"})}),(0,t.jsx)(n.td,{children:"string"}),(0,t.jsx)(n.td,{children:"No"}),(0,t.jsx)(n.td,{children:"Brief description of observed behavior (optional)"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"timestamp-format",children:"Timestamp Format"}),"\n",(0,t.jsxs)(n.p,{children:["Both ",(0,t.jsx)(n.strong,{children:"Unix seconds"})," and ",(0,t.jsx)(n.strong,{children:"Unix milliseconds"})," are supported:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Unix seconds: 1702382400\nUnix milliseconds: 1702382400000\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Getting current time"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Current time (Unix seconds)\ndate +%s\n# Output: 1702386000\n\n# Incident start (15 minutes ago)\ndate -d "15 minutes ago" +%s\n# Output: 1702385100\n'})}),"\n",(0,t.jsx)(n.h3,{id:"incident-window-calculation",children:"Incident Window Calculation"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"How the prompt determines time range"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"# If current_time not provided\nanalysis_end = now()\n\n# Investigation window\nanalysis_start = incident_start_time - 15 minutes  # Look for precursors\nanalysis_end = current_time (or now)\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"incident_start_time: 10:00\ncurrent_time: 10:15 (or omitted)\n\nActual window analyzed: 09:45 to 10:15\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Capture events before symptoms appeared"]}),"\n",(0,t.jsx)(n.h2,{id:"workflow",children:"Workflow"}),"\n",(0,t.jsx)(n.p,{children:"The prompt guides the LLM through an 8-step rapid investigation:"}),"\n",(0,t.jsx)(n.h3,{id:"step-1-confirm-parameters--calculate-window",children:"Step 1: Confirm Parameters & Calculate Window"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What happens"}),": LLM establishes investigation scope"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Output"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'Incident started: [incident_start_time]\nCurrent time: [current_time or now]\nNamespace filter: [namespace] (or "all namespaces")\nSymptoms: [symptoms description] (if provided)\n\nInvestigation window: [start -15min] to [current_time]\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Set boundaries and context for rapid analysis"]}),"\n",(0,t.jsx)(n.h3,{id:"step-2-identify-critical-resources",children:"Step 2: Identify Critical Resources"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Tool called"}),": ",(0,t.jsx)(n.code,{children:"cluster_health"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Parameters"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": "<incident_start_time - 15min>",\n  "end_time": "<current_time or now>",\n  "namespace": "<namespace>" // if provided\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What it provides"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Resources in Error state NOW"}),"\n",(0,t.jsx)(n.li,{children:"Top issues currently occurring"}),"\n",(0,t.jsx)(n.li,{children:"Affected resource counts by kind"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Quickly identify what's broken RIGHT NOW"]}),"\n",(0,t.jsx)(n.h3,{id:"step-3-identify-recent-changes",children:"Step 3: Identify Recent Changes"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Tool called"}),": ",(0,t.jsx)(n.code,{children:"resource_changes"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Parameters"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": "<incident_start_time - 15min>",\n  "end_time": "<current_time or now>",\n  "impact_threshold": 0.3,\n  "max_resources": 20\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What it provides"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"What changed around incident start"}),"\n",(0,t.jsx)(n.li,{children:"High-impact changes (deployments, config updates)"}),"\n",(0,t.jsx)(n.li,{children:"Correlation between changes and failures"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),': Find "what changed just before this started?"']}),"\n",(0,t.jsx)(n.h3,{id:"step-4-investigate-failing-resources",children:"Step 4: Investigate Failing Resources"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Tool called"}),": ",(0,t.jsx)(n.code,{children:"investigate"})," (for top 2-3 Error resources from Step 2)"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Parameters"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "resource_kind": "<kind>",\n  "resource_name": "<name>",\n  "namespace": "<namespace>",\n  "start_time": "<incident_start_time - 15min>",\n  "end_time": "<current_time or now>",\n  "investigation_type": "incident"\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What it provides"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Recent timeline with status transitions"}),"\n",(0,t.jsx)(n.li,{children:"Latest events and error messages"}),"\n",(0,t.jsx)(n.li,{children:"RCA prompts focused on immediate mitigation"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Understand WHY resources are failing"]}),"\n",(0,t.jsx)(n.h3,{id:"step-5-correlate-events-to-root-cause",children:"Step 5: Correlate Events to Root Cause"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"LLM analyzes"})," tool outputs to identify likely cause:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Correlation:\n[09:58] Deployment/production/api-server updated (v1.2 \u2192 v1.3)\n[10:00] Pod/production/api-server-85f6c9b8-k4x2p \u2192 Error\n[10:00] Event: CrashLoopBackOff (container startup failure)\n\nLikely Cause: Image v1.3 has startup issue\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),': Connect "what changed" to "what\'s failing"']}),"\n",(0,t.jsx)(n.h3,{id:"step-6-recommend-immediate-mitigation",children:"Step 6: Recommend Immediate Mitigation"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"LLM provides"})," concrete action steps:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Immediate Mitigation Steps:\n\n1. Rollback Deployment (Fastest Recovery):\n   kubectl rollout undo deployment/api-server -n production\n\n2. Check Pod Logs (Verify Root Cause):\n   kubectl logs api-server-85f6c9b8-k4x2p -n production --previous\n\n3. Monitor Recovery:\n   kubectl get pods -n production -l app=api-server -w\n\nExpected Recovery Time: 30-60 seconds\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Give operator immediate actionable steps"]}),"\n",(0,t.jsx)(n.h3,{id:"step-7-suggest-monitoring--follow-up",children:"Step 7: Suggest Monitoring & Follow-Up"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"LLM lists"})," what to watch:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Monitor for:\n- New pods becoming Ready (kubectl get pods -w)\n- Service endpoint health (kubectl get endpoints api-server)\n- Error rate metrics (check Prometheus/Datadog)\n\nFollow-Up Actions:\n1. Verify rollback completed successfully\n2. Run full post-mortem once resolved\n3. Review deployment pipeline for v1.3 issues\n4. Add pre-deployment validation tests\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Ensure successful mitigation and prevent recurrence"]}),"\n",(0,t.jsx)(n.h3,{id:"step-8-list-additional-data-needed",children:"Step 8: List Additional Data Needed"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"LLM identifies"})," information gaps:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Additional Investigation (If Mitigation Fails):\n\n1. Container logs:\n   kubectl logs <pod-name> -n production --previous\n\n2. Pod details:\n   kubectl describe pod <pod-name> -n production\n\n3. Recent changes:\n   kubectl rollout history deployment/api-server -n production\n\n4. Node status (if suspecting node issues):\n   kubectl describe node <node-name>\n\n5. Application metrics:\n   Check Prometheus/Datadog for error spike timing\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Guide deeper investigation if initial mitigation insufficient"]}),"\n",(0,t.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,t.jsx)(n.h3,{id:"1-focus-on-recent-data",children:"1. Focus on Recent Data"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"How it works"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Automatically looks 15 minutes before ",(0,t.jsx)(n.code,{children:"incident_start_time"})]}),"\n",(0,t.jsx)(n.li,{children:"Captures precursor events (deployments, config changes)"}),"\n",(0,t.jsx)(n.li,{children:"Focuses on current state (Error resources)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Incident reported at 10:00\nWindow analyzed: 09:45 to 10:15\n\nFindings:\n[09:58] ConfigMap updated (precursor found!)\n[10:00] Pods started failing (symptom onset)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-immediate-actions",children:"2. Immediate Actions"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"How it works"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Provides kubectl commands ready to execute"}),"\n",(0,t.jsx)(n.li,{children:"Prioritizes fastest recovery path"}),"\n",(0,t.jsx)(n.li,{children:"Includes rollback, restart, scale commands"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'\u2705 Good: "kubectl rollout undo deployment/api-server -n production"\n         (Concrete, executable command)\n\n\u274c Bad: "Consider rolling back the deployment"\n        (Vague, requires operator to figure out how)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"3-acknowledges-uncertainty",children:"3. Acknowledges Uncertainty"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"How it works"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Marks hypotheses vs. confirmed facts"}),"\n",(0,t.jsx)(n.li,{children:"States when more data is needed"}),"\n",(0,t.jsx)(n.li,{children:"Provides paths to get missing information"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Confirmed (from tool data):\n- Pod api-server-85f6c9b8-k4x2p in CrashLoopBackOff\n- Deployment updated at 09:58\n\nHypothesis (Requires Verification):\n- Container startup failing due to missing environment variable\n  \u2192 Verify with: kubectl logs <pod> --previous\n"})}),"\n",(0,t.jsx)(n.h3,{id:"4-no-hallucinations",children:"4. No Hallucinations"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"How it works"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Same grounding principles as post-mortem prompt"}),"\n",(0,t.jsx)(n.li,{children:"Only reports events from tool outputs"}),"\n",(0,t.jsx)(n.li,{children:"Forbidden to infer without evidence"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'\u2705 Good: "resource_changes shows Deployment updated at 09:58,\n         investigate shows Pod failed at 10:00 (2min after)"\n         (Directly from tool data)\n\n\u274c Bad: "The deployment probably caused a memory leak"\n        (Speculation without evidence)\n'})}),"\n",(0,t.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,t.jsx)(n.h3,{id:"example-1-via-claude-desktop-natural-language",children:"Example 1: Via Claude Desktop (Natural Language)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"User"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Pods are failing in the production namespace. Started about 10 minutes ago.\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What happens"}),":"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Claude recognizes this as live incident"}),"\n",(0,t.jsx)(n.li,{children:"Calculates incident_start_time (now - 10 minutes)"}),"\n",(0,t.jsxs)(n.li,{children:["Calls ",(0,t.jsx)(n.code,{children:"live_incident_handling"})," prompt"]}),"\n",(0,t.jsx)(n.li,{children:"Executes 8-step workflow"}),"\n",(0,t.jsx)(n.li,{children:"Returns immediate mitigation steps"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"LLM Output"})," (abbreviated):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"## Immediate Situation\nIncident started: ~10 minutes ago\nNamespace: production\nStatus: Active (ongoing)\n\n## Current Impact\n- 3 Pods in Error state (CrashLoopBackOff)\n- Service api-server has no ready endpoints\n- Deployment api-server in Warning state\n\n## Likely Root Cause\nDeployment updated 12 minutes ago (v1.2.0 \u2192 v1.3.0)\nPods failing to start immediately after update\n\nEvidence:\n- resource_changes: Deployment impact_score 0.65\n- investigate: Pod transition Running \u2192 Error at 10:02\n\n## Immediate Mitigation Steps\n\n1. Rollback Deployment (30-60 sec recovery):\n   kubectl rollout undo deployment/api-server -n production\n\n2. Verify Rollback:\n   kubectl rollout status deployment/api-server -n production\n\n3. Check Recovery:\n   kubectl get pods -n production -l app=api-server\n\nExpected Recovery: 30-60 seconds\n\n## Verification\nAfter rollback, confirm:\n- kubectl logs <new-pod-name> -n production --previous\n  \u2192 Check why v1.3.0 failed to start\n\n## Next Steps\n1. Wait for rollback completion\n2. Run post-mortem analysis\n3. Fix v1.3.0 issues before retry\n"})}),"\n",(0,t.jsx)(n.h3,{id:"example-2-via-mcp-api",children:"Example 2: Via MCP API"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "method": "prompts/get",\n  "params": {\n    "name": "live_incident_handling",\n    "arguments": {\n      "incident_start_time": 1702385100,\n      "namespace": "production",\n      "symptoms": "API returning 500 errors, pods crashing"\n    }\n  },\n  "id": 1\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Note"}),": ",(0,t.jsx)(n.code,{children:"current_time"})," omitted, will default to now()"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Response"}),": (prompt executed, LLM calls tools and generates mitigation steps)"]}),"\n",(0,t.jsx)(n.h3,{id:"example-3-resource-quota-issue",children:"Example 3: Resource Quota Issue"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"User"})," (Claude Desktop):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Deployment can't scale up. Pods stuck in Pending. Started 5 minutes ago.\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Tools Called"}),":"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"cluster_health"})," \u2192 0 Error pods, but Deployment in Warning"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"resource_changes"})," \u2192 Deployment scale event (3 \u2192 5 replicas)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"investigate"})," (Deployment) \u2192 Event: FailedCreate (quota exceeded)"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"LLM Output"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"## Root Cause\nResource quota exceeded during scale-up\n\nTimeline:\n[10:10] Deployment scaled 3 \u2192 5 replicas\n[10:10] Event: FailedCreate - exceeded quota: pods=5, limit=3\n\n## Immediate Mitigation\n\nOption 1 (Fastest - Scale Back):\nkubectl scale deployment/app --replicas=3 -n production\n\nOption 2 (Increase Quota):\n# Edit namespace quota\nkubectl edit resourcequota production-quota -n production\n# Increase pods limit from 3 to 5\n\n## Recommendation\nUse Option 1 (scale back) immediately if service is degraded.\nIncrease quota during next maintenance window.\n\n## Verification\nkubectl get pods -n production\n\u2192 Should see 3 running pods after scale-back\n"})}),"\n",(0,t.jsx)(n.h2,{id:"integration-with-tools",children:"Integration with Tools"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  User: "Pods failing in production"         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n                 v\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Prompt: live_incident_handling              \u2502\n\u2502  - Calculates: start_time - 15min           \u2502\n\u2502  - Focuses: Current Error resources         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                 \u2502\n       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n       v         v          v             v\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502cluster     \u2502 \u2502resource   \u2502 \u2502investigate\u2502 \u2502(optional)\u2502\n\u2502_health     \u2502 \u2502_changes   \u2502 \u2502(\xd72-3 res)\u2502 \u2502explorer  \u2502\n\u2502NOW        \u2502 \u2502RECENT     \u2502 \u2502INCIDENT   \u2502 \u2502          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502             \u2502            \u2502            \u2502\n       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                        v\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n         \u2502 LLM Provides:                \u2502\n         \u2502 - Immediate mitigation steps \u2502\n         \u2502 - kubectl commands           \u2502\n         \u2502 - Recovery monitoring        \u2502\n         \u2502 - Follow-up actions          \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n'})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(n.h3,{id:"-do",children:"\u2705 Do"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Act quickly"})," - Run prompt as soon as incident detected"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Provide symptoms"})," - Helps LLM focus investigation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Execute mitigation"})," - Run suggested kubectl commands"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Monitor recovery"})," - Watch for pod/service stabilization"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Verify hypothesis"})," - Check logs after mitigation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Run post-mortem"})," - Full analysis after recovery"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use for triage"})," - Quick assessment before manual intervention"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Specify namespace"})," - Faster analysis when scoped"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"-dont",children:"\u274c Don't"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Don't delay"})," - Prompt optimized for real-time use"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Don't skip verification"})," - Always check container logs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Don't ignore follow-up"})," - Post-mortem prevents recurrence"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Don't assume complete"})," - LLM analysis limited to Spectre data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Don't use for old incidents"})," - Use ",(0,t.jsx)(n.code,{children:"post_mortem_incident_analysis"})," instead"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Don't execute blindly"})," - Understand mitigation before running"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Don't expect logs"})," - Prompt cannot access container stdout/stderr"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Don't use without tools"})," - Requires MCP server connection"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,t.jsx)(n.h3,{id:"1-real-time-data-only",children:"1. Real-Time Data Only"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Limitation"}),": Analyzes events up to current_time"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What's Missing"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Future events (obviously)"}),"\n",(0,t.jsx)(n.li,{children:"Events after analysis completes"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Mitigation"}),": Re-run prompt if situation changes"]}),"\n",(0,t.jsx)(n.h3,{id:"2-no-container-logs",children:"2. No Container Logs"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Limitation"}),": Cannot access pod logs directly"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What's Missing"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Container stdout/stderr"}),"\n",(0,t.jsx)(n.li,{children:"Application error messages"}),"\n",(0,t.jsx)(n.li,{children:"Startup failure reasons"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Mitigation"}),": Prompt suggests kubectl logs commands"]}),"\n",(0,t.jsx)(n.h3,{id:"3-no-external-metrics",children:"3. No External Metrics"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Limitation"}),": Spectre data only (no Prometheus, Datadog, etc.)"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"What's Missing"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"CPU/memory metrics"}),"\n",(0,t.jsx)(n.li,{children:"Request rates, latencies"}),"\n",(0,t.jsx)(n.li,{children:"Custom application metrics"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Mitigation"}),": Prompt recommends checking external tools"]}),"\n",(0,t.jsx)(n.h3,{id:"4-hypothesis-vs-fact",children:"4. Hypothesis vs. Fact"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Limitation"}),": LLM may form hypotheses without full evidence"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Mitigation"}),': Prompt explicitly marks "Hypothesis (Unconfirmed)" vs. "Confirmed"']}),"\n",(0,t.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/spectre/docs/mcp-integration/prompts-reference/post-mortem",children:"post_mortem_incident_analysis Prompt"})," - Historical incident analysis after resolution"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/spectre/docs/mcp-integration/tools-reference/cluster-health",children:"cluster_health Tool"})," - Current cluster status (used by prompt)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/spectre/docs/mcp-integration/tools-reference/resource-changes",children:"resource_changes Tool"})," - Recent changes (used by prompt)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/spectre/docs/mcp-integration/tools-reference/investigate",children:"investigate Tool"})," - Resource timelines (used by prompt with type=incident)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"/spectre/docs/configuration/mcp-configuration",children:"MCP Configuration"})," - MCP server setup"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(6540);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);