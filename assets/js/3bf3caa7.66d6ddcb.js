"use strict";(globalThis.webpackChunkspectre_docs=globalThis.webpackChunkspectre_docs||[]).push([[4633],{6693:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"use-cases/deployment-tracking","title":"Deployment Tracking","description":"Monitor Kubernetes deployments proactively with real-time event tracking and rollout verification","source":"@site/docs/use-cases/deployment-tracking.md","sourceDirName":"use-cases","slug":"/use-cases/deployment-tracking","permalink":"/spectre/docs/use-cases/deployment-tracking","draft":false,"unlisted":false,"editUrl":"https://github.com/moolen/spectre/tree/master/docs/docs/use-cases/deployment-tracking.md","tags":[],"version":"current","lastUpdatedBy":"Moritz Johner","lastUpdatedAt":1765616329000,"frontMatter":{"title":"Deployment Tracking","description":"Monitor Kubernetes deployments proactively with real-time event tracking and rollout verification","keywords":["deployment","rollout","tracking","monitoring","verification","ci/cd","kubernetes"]},"sidebar":"docsSidebar","previous":{"title":"Post-Mortem Analysis","permalink":"/spectre/docs/use-cases/post-mortem-analysis"},"next":{"title":"MCP Integration","permalink":"/spectre/docs/mcp-integration/"}}');var i=r(4848),t=r(8453);const l={title:"Deployment Tracking",description:"Monitor Kubernetes deployments proactively with real-time event tracking and rollout verification",keywords:["deployment","rollout","tracking","monitoring","verification","ci/cd","kubernetes"]},o="Deployment Tracking",a={},d=[{value:"Overview",id:"overview",level:2},{value:"Deployment Lifecycle",id:"deployment-lifecycle",level:2},{value:"1. Deployment Update",id:"1-deployment-update",level:3},{value:"2. Pod Rollout",id:"2-pod-rollout",level:3},{value:"3. Service Update",id:"3-service-update",level:3},{value:"4. Completion",id:"4-completion",level:3},{value:"Step-by-Step Deployment Tracking",id:"step-by-step-deployment-tracking",level:2},{value:"Step 1: Start Tracking Before Deployment",id:"step-1-start-tracking-before-deployment",level:3},{value:"Step 2: Apply Deployment",id:"step-2-apply-deployment",level:3},{value:"Step 3: Monitor Rollout Progress",id:"step-3-monitor-rollout-progress",level:3},{value:"Step 4: Detect Issues Early",id:"step-4-detect-issues-early",level:3},{value:"ImagePullBackOff",id:"imagepullbackoff",level:4},{value:"CrashLoopBackOff",id:"crashloopbackoff",level:4},{value:"ConfigMap/Secret Not Found",id:"configmapsecret-not-found",level:4},{value:"Readiness Probe Failure",id:"readiness-probe-failure",level:4},{value:"Step 5: Verify Deployment Success",id:"step-5-verify-deployment-success",level:3},{value:"Step 6: Rollback Decision",id:"step-6-rollback-decision",level:3},{value:"CI/CD Pipeline Integration",id:"cicd-pipeline-integration",level:2},{value:"Automated Verification",id:"automated-verification",level:3},{value:"Progressive Delivery",id:"progressive-delivery",level:3},{value:"Using MCP for Deployment Tracking",id:"using-mcp-for-deployment-tracking",level:2},{value:"Conversational Deployment Verification",id:"conversational-deployment-verification",level:3},{value:"MCP Query Examples",id:"mcp-query-examples",level:3},{value:"Deployment Tracking Queries",id:"deployment-tracking-queries",level:2},{value:"Query All Deployment Activity",id:"query-all-deployment-activity",level:3},{value:"Query Specific Deployment Timeline",id:"query-specific-deployment-timeline",level:3},{value:"Query Pod Failures During Deployment",id:"query-pod-failures-during-deployment",level:3},{value:"Query ConfigMap/Secret Changes",id:"query-configmapsecret-changes",level:3},{value:"Query Service Endpoint Changes",id:"query-service-endpoint-changes",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 Do",id:"-do",level:3},{value:"\u274c Don&#39;t",id:"-dont",level:3},{value:"Example Deployment Scenarios",id:"example-deployment-scenarios",level:2},{value:"Scenario 1: Successful Deployment",id:"scenario-1-successful-deployment",level:3},{value:"Scenario 2: Failed Deployment (CrashLoopBackOff)",id:"scenario-2-failed-deployment-crashloopbackoff",level:3},{value:"Scenario 3: Config Change Causes Failure",id:"scenario-3-config-change-causes-failure",level:3},{value:"Scenario 4: Image Pull Failure",id:"scenario-4-image-pull-failure",level:3},{value:"Monitoring Integration",id:"monitoring-integration",level:2},{value:"Prometheus Alerts",id:"prometheus-alerts",level:3},{value:"GitOps Integration (FluxCD)",id:"gitops-integration-fluxcd",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Deployment Not Progressing",id:"deployment-not-progressing",level:3},{value:"Pods Created But Not Ready",id:"pods-created-but-not-ready",level:3},{value:"Endpoints Not Updating",id:"endpoints-not-updating",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"deployment-tracking",children:"Deployment Tracking"})}),"\n",(0,i.jsx)(n.p,{children:"Track deployment rollouts in real-time, detect issues early, and verify successful deployments using Spectre's comprehensive event monitoring."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"Deployment tracking helps you:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Monitor rollout progress"})," - Real-time visibility into pod creation and readiness"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Detect issues early"})," - Catch failures before they impact all replicas"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Verify success"})," - Confirm deployments completed without errors"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Enable fast rollbacks"})," - Identify problems quickly for faster recovery"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Integrate with CI/CD"})," - Automated deployment verification in pipelines"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Time saved"}),": 3-5 minutes per deployment through automated verification and early issue detection."]}),"\n",(0,i.jsx)(n.h2,{id:"deployment-lifecycle",children:"Deployment Lifecycle"}),"\n",(0,i.jsx)(n.p,{children:"A typical Kubernetes deployment involves multiple resource changes that Spectre tracks:"}),"\n",(0,i.jsx)(n.h3,{id:"1-deployment-update",children:"1. Deployment Update"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Trigger"}),": ",(0,i.jsx)(n.code,{children:"kubectl apply"})," or GitOps reconciliation"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Events captured"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Deployment spec change (image, replicas, config)"}),"\n",(0,i.jsx)(n.li,{children:"ReplicaSet creation (new version)"}),"\n",(0,i.jsx)(n.li,{children:"Old ReplicaSet scale-down (rolling update)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-pod-rollout",children:"2. Pod Rollout"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Trigger"}),": ReplicaSet controller creates pods"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Events captured"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Pod created (Pending state)"}),"\n",(0,i.jsx)(n.li,{children:"Container image pull"}),"\n",(0,i.jsx)(n.li,{children:"Pod started (Running state)"}),"\n",(0,i.jsx)(n.li,{children:"Readiness probe checks"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"3-service-update",children:"3. Service Update"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Trigger"}),": Pods become ready"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Events captured"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Endpoints added (new pods)"}),"\n",(0,i.jsx)(n.li,{children:"Endpoints removed (old pods)"}),"\n",(0,i.jsx)(n.li,{children:"Service traffic shift"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"4-completion",children:"4. Completion"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Trigger"}),": All new pods ready, old pods terminated"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Events captured"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Deployment status: Progressing \u2192 Available"}),"\n",(0,i.jsx)(n.li,{children:"Old ReplicaSet scaled to 0"}),"\n",(0,i.jsx)(n.li,{children:"Old pods terminated"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"step-by-step-deployment-tracking",children:"Step-by-Step Deployment Tracking"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-start-tracking-before-deployment",children:"Step 1: Start Tracking Before Deployment"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Capture baseline"})," before applying changes:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Note current deployment state\nkubectl get deployment api-server -n production -o yaml > pre-deployment.yaml\n\n# Record timestamp for Spectre query\nDEPLOY_START=$(date +%s)\necho "Deployment started at: $(date -u)"\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Query current state"})," in Spectre:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:Deployment,name:api-server,namespace:production\nTime range: Last 5 minutes\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Verify"}),": Current image version, replica count, and status."]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-apply-deployment",children:"Step 2: Apply Deployment"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Execute deployment"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Via kubectl\nkubectl set image deployment/api-server api-server=v1.3.0 -n production\n\n# Via GitOps (commit and push)\ngit commit -m "Update api-server to v1.3.0"\ngit push origin main\n# (FluxCD or ArgoCD will reconcile)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-monitor-rollout-progress",children:"Step 3: Monitor Rollout Progress"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Query deployment events"})," in real-time:"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Spectre UI"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Navigate to Spectre UI"}),"\n",(0,i.jsx)(n.li,{children:'Set time range: "Last 15 minutes" (auto-refresh)'}),"\n",(0,i.jsxs)(n.li,{children:["Query: ",(0,i.jsx)(n.code,{children:"kind:Deployment OR kind:ReplicaSet OR kind:Pod,namespace:production,name:api-server"})]}),"\n",(0,i.jsx)(n.li,{children:"Watch timeline as events appear"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Spectre API"})," (programmatic):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Poll for deployment events every 10 seconds\nwhile true; do\n  CURRENT_TIME=$(date +%s)\n  curl -s "http://spectre:8080/api/search?query=kind:Deployment,name:api-server,namespace:production&start=$DEPLOY_START&end=$CURRENT_TIME" | \\\n    jq -r \'.events[] | "\\(.timestamp) - \\(.message)"\'\n  sleep 10\ndone\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected events during healthy rollout"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[10:15:00] Deployment/api-server - Updated: image v1.2.0 \u2192 v1.3.0\n[10:15:02] ReplicaSet/api-server-7d9f8c5b - Created (new version)\n[10:15:05] Pod/api-server-7d9f8c5b-x7k2p - Created (Pending)\n[10:15:08] Pod/api-server-7d9f8c5b-x7k2p - Image pulled successfully\n[10:15:10] Pod/api-server-7d9f8c5b-x7k2p - Status: Running\n[10:15:15] Pod/api-server-7d9f8c5b-x7k2p - Ready (passed readiness probe)\n[10:15:18] Endpoints/api-server - Added endpoint (new pod)\n[10:15:20] Pod/api-server-9c8f7b6d-a3m5n - Terminating (old version)\n[10:15:25] Deployment/api-server - Status: Available (rollout complete)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-detect-issues-early",children:"Step 4: Detect Issues Early"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Query for error events"})," during rollout:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: status:Error OR status:Warning,namespace:production\nTime range: Since deployment start\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Common issues detected"}),":"]}),"\n",(0,i.jsx)(n.h4,{id:"imagepullbackoff",children:"ImagePullBackOff"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Spectre shows"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'[10:15:08] Pod/api-server-7d9f8c5b-x7k2p - Status: Error\n           Event: "Failed to pull image v1.3.0: authentication required"\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Image doesn't exist or registry credentials invalid"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Fix: Verify image tag exists\ndocker pull registry.example.com/api-server:v1.3.0\n\n# If credentials issue, update secret\nkubectl create secret docker-registry regcred \\\n  --docker-server=registry.example.com \\\n  --docker-username=user \\\n  --docker-password=pass \\\n  -n production\n"})}),"\n",(0,i.jsx)(n.h4,{id:"crashloopbackoff",children:"CrashLoopBackOff"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Spectre shows"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'[10:15:12] Pod/api-server-7d9f8c5b-x7k2p - Status: Running\n[10:15:15] Pod/api-server-7d9f8c5b-x7k2p - Status: Error\n           Event: "Back-off restarting failed container"\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Application crashes on startup"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check logs for crash reason\nkubectl logs api-server-7d9f8c5b-x7k2p -n production\n\n# Common causes:\n# - Missing environment variables\n# - Config file errors\n# - Database connection failures\n"})}),"\n",(0,i.jsx)(n.h4,{id:"configmapsecret-not-found",children:"ConfigMap/Secret Not Found"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Spectre shows"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[10:15:10] Pod/api-server-7d9f8c5b-x7k2p - Status: Error\n           Event: \"Error: configmap 'api-config' not found\"\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Referenced config doesn't exist"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Verify ConfigMap exists\nkubectl get configmap api-config -n production\n\n# If missing, create it\nkubectl apply -f config/api-config.yaml\n"})}),"\n",(0,i.jsx)(n.h4,{id:"readiness-probe-failure",children:"Readiness Probe Failure"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Spectre shows"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[10:15:15] Pod/api-server-7d9f8c5b-x7k2p - Status: Running\n[10:16:00] Pod/api-server-7d9f8c5b-x7k2p - Warning: Readiness probe failed\n           (Pod never becomes Ready)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Application healthy but probe misconfigured"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Check probe definition\nkubectl get deployment api-server -n production -o yaml | grep -A10 readinessProbe\n\n# Test probe endpoint\nkubectl exec api-server-7d9f8c5b-x7k2p -n production -- curl localhost:8080/health\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-5-verify-deployment-success",children:"Step 5: Verify Deployment Success"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Success criteria"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 All new pods in Running state"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 All new pods passed readiness checks"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Endpoints updated with new pods"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Old pods terminated"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 No error events"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Query for verification"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:Pod,namespace:production,label:app=api-server\nTime range: Last 30 minutes\nStatus filter: Error OR Warning\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected result"}),": No error events, or only old pod termination events."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Verification script"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'DEPLOY_END=$(date +%s)\n\n# Query Spectre for errors during deployment window\nERROR_COUNT=$(curl -s "http://spectre:8080/api/search?query=kind:Pod,namespace:production,status:Error&start=$DEPLOY_START&end=$DEPLOY_END" | \\\n  jq \'[.events[] | select(.name | contains("api-server"))] | length\')\n\nif [ "$ERROR_COUNT" -eq 0 ]; then\n  echo "\u2705 Deployment successful - No errors detected"\n  exit 0\nelse\n  echo "\u274c Deployment failed - $ERROR_COUNT error events detected"\n  exit 1\nfi\n'})}),"\n",(0,i.jsx)(n.h3,{id:"step-6-rollback-decision",children:"Step 6: Rollback Decision"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"When to rollback"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u274c New pods failing to start (CrashLoopBackOff, ImagePullBackOff)"}),"\n",(0,i.jsx)(n.li,{children:"\u274c Readiness probes failing after 5+ minutes"}),"\n",(0,i.jsx)(n.li,{children:"\u274c Error rate spike in application metrics"}),"\n",(0,i.jsx)(n.li,{children:"\u274c Multiple pods stuck in Pending state"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Rollback with kubectl"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Option 1: Rollback to previous version\nkubectl rollout undo deployment/api-server -n production\n\n# Option 2: Rollback to specific revision\nkubectl rollout history deployment/api-server -n production\nkubectl rollout undo deployment/api-server -n production --to-revision=3\n\n# Verify rollback success\nkubectl rollout status deployment/api-server -n production\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Track rollback in Spectre"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:Deployment,name:api-server,namespace:production\nTime range: Last 15 minutes\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected events"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[10:20:00] Deployment/api-server - Updated: image v1.3.0 \u2192 v1.2.0 (rollback)\n[10:20:05] ReplicaSet/api-server-9c8f7b6d - Scaled up (previous version)\n[10:20:10] Pods created with v1.2.0 image\n[10:20:30] Service traffic shifted back to v1.2.0\n"})}),"\n",(0,i.jsx)(n.h2,{id:"cicd-pipeline-integration",children:"CI/CD Pipeline Integration"}),"\n",(0,i.jsx)(n.h3,{id:"automated-verification",children:"Automated Verification"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Integration pattern"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"CI/CD applies deployment"}),"\n",(0,i.jsx)(n.li,{children:"Wait for rollout to stabilize (30-60 seconds)"}),"\n",(0,i.jsx)(n.li,{children:"Query Spectre for error events"}),"\n",(0,i.jsx)(n.li,{children:"Pass/fail pipeline based on results"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example GitLab CI/CD"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'deploy:\n  stage: deploy\n  script:\n    # Record deployment start time\n    - export DEPLOY_START=$(date +%s)\n\n    # Apply deployment\n    - kubectl set image deployment/api-server api-server=${CI_COMMIT_SHORT_SHA} -n production\n\n    # Wait for rollout\n    - kubectl rollout status deployment/api-server -n production --timeout=5m\n\n    # Verify with Spectre\n    - |\n      export DEPLOY_END=$(date +%s)\n      ERROR_COUNT=$(curl -s "http://spectre:8080/api/search?query=kind:Pod,namespace:production,status:Error&start=$DEPLOY_START&end=$DEPLOY_END" | \\\n        jq \'[.events[] | select(.name | contains("api-server"))] | length\')\n\n      if [ "$ERROR_COUNT" -gt 0 ]; then\n        echo "\u274c Deployment verification failed - errors detected"\n        kubectl rollout undo deployment/api-server -n production\n        exit 1\n      fi\n\n      echo "\u2705 Deployment verified successfully"\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Example GitHub Actions"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'- name: Deploy and Verify\n  run: |\n    export DEPLOY_START=$(date +%s)\n\n    # Apply deployment\n    kubectl set image deployment/api-server api-server=${{ github.sha }} -n production\n\n    # Wait for rollout\n    kubectl rollout status deployment/api-server -n production --timeout=5m\n\n    # Query Spectre for verification\n    sleep 10  # Allow events to be indexed\n\n    ERROR_EVENTS=$(curl -s "http://spectre:8080/api/search?query=kind:Pod,namespace:production,status:Error&start=$DEPLOY_START&end=$(date +%s)" | jq -r \'.events[]\')\n\n    if [ -n "$ERROR_EVENTS" ]; then\n      echo "::error::Deployment verification failed"\n      echo "$ERROR_EVENTS" | jq .\n      kubectl rollout undo deployment/api-server -n production\n      exit 1\n    fi\n\n    echo "::notice::Deployment verified successfully"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"progressive-delivery",children:"Progressive Delivery"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Canary deployments"})," with Spectre monitoring:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Phase 1: Deploy canary (10% traffic)\nkubectl set image deployment/api-server-canary api-server=v1.3.0 -n production\nkubectl scale deployment/api-server-canary --replicas=1\n\n# Monitor canary with Spectre (5 minutes)\nsleep 300\n\n# Query canary pod health\nCANARY_ERRORS=$(curl -s "http://spectre:8080/api/search?query=kind:Pod,namespace:production,label:version=canary,status:Error&start=$(date -d \'5 minutes ago\' +%s)&end=$(date +%s)" | jq \'.events | length\')\n\nif [ "$CANARY_ERRORS" -eq 0 ]; then\n  echo "\u2705 Canary healthy - Proceeding with full rollout"\n  kubectl set image deployment/api-server api-server=v1.3.0 -n production\nelse\n  echo "\u274c Canary unhealthy - Aborting rollout"\n  kubectl delete deployment api-server-canary -n production\n  exit 1\nfi\n'})}),"\n",(0,i.jsx)(n.h2,{id:"using-mcp-for-deployment-tracking",children:"Using MCP for Deployment Tracking"}),"\n",(0,i.jsx)(n.h3,{id:"conversational-deployment-verification",children:"Conversational Deployment Verification"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"With Claude Desktop + MCP"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"You: I just deployed api-server to v1.3.0 in production namespace. Verify it's healthy.\n\nClaude: [Automatically uses resource_changes and investigate tools]\n\nI've analyzed the deployment:\n\n\u2705 Deployment Status: Successful\n- Deployment updated at 10:15:00 UTC\n- 3 new pods created successfully\n- All pods reached Running and Ready state\n- Endpoints updated at 10:15:18 UTC\n- Old pods terminated cleanly\n\n\u26a0\ufe0f Minor Issues Detected:\n- Pod api-server-7d9f8c5b-x7k2p took 2 retry attempts to pull image\n  (transient registry issue, resolved)\n\nOverall: Deployment completed successfully. No action needed.\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural language rollback"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"You: Pods are crashing after the deployment. Rollback immediately.\n\nClaude: [Investigates crash events, provides rollback command]\n\nI found CrashLoopBackOff events starting at 10:15:15.\nRoot cause: Missing DATABASE_URL environment variable in new image.\n\nImmediate rollback command:\nkubectl rollout undo deployment/api-server -n production\n\nThen fix the issue by adding DATABASE_URL to deployment spec.\n"})}),"\n",(0,i.jsx)(n.h3,{id:"mcp-query-examples",children:"MCP Query Examples"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Check deployment progress"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Via MCP HTTP API\ncurl -X POST http://localhost:8081/mcp/v1 \\\n  -H "Content-Type: application/json" \\\n  -d "{\n    \\"jsonrpc\\": \\"2.0\\",\n    \\"method\\": \\"tools/call\\",\n    \\"params\\": {\n      \\"name\\": \\"resource_changes\\",\n      \\"arguments\\": {\n        \\"start_time\\": $(date -d \'15 minutes ago\' +%s),\n        \\"end_time\\": $(date +%s),\n        \\"namespace\\": \\"production\\",\n        \\"kinds\\": [\\"Deployment\\", \\"Pod\\", \\"ReplicaSet\\"]\n      }\n    },\n    \\"id\\": 1\n  }"\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Investigate failed deployment"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:8081/mcp/v1 \\\n  -H "Content-Type: application/json" \\\n  -d "{\n    \\"jsonrpc\\": \\"2.0\\",\n    \\"method\\": \\"tools/call\\",\n    \\"params\\": {\n      \\"name\\": \\"investigate\\",\n      \\"arguments\\": {\n        \\"kind\\": \\"Deployment\\",\n        \\"namespace\\": \\"production\\",\n        \\"name\\": \\"api-server\\",\n        \\"start_time\\": $(date -d \'1 hour ago\' +%s),\n        \\"end_time\\": $(date +%s)\n      }\n    },\n    \\"id\\": 2\n  }"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"deployment-tracking-queries",children:"Deployment Tracking Queries"}),"\n",(0,i.jsx)(n.h3,{id:"query-all-deployment-activity",children:"Query All Deployment Activity"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:Deployment OR kind:ReplicaSet\nTime range: Last 1 hour\nNamespace: production\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Overview of all deployment changes in timeframe."]}),"\n",(0,i.jsx)(n.h3,{id:"query-specific-deployment-timeline",children:"Query Specific Deployment Timeline"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: name:api-server\nTime range: 30 minutes ago to now\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Complete timeline for single deployment (all related resources)."]}),"\n",(0,i.jsx)(n.h3,{id:"query-pod-failures-during-deployment",children:"Query Pod Failures During Deployment"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:Pod,status:Error,namespace:production\nTime range: Since deployment start\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Identify which pods failed and why during rollout."]}),"\n",(0,i.jsx)(n.h3,{id:"query-configmapsecret-changes",children:"Query ConfigMap/Secret Changes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:ConfigMap OR kind:Secret,namespace:production\nTime range: 1 hour ago to now\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Verify config changes applied before deployment."]}),"\n",(0,i.jsx)(n.h3,{id:"query-service-endpoint-changes",children:"Query Service Endpoint Changes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:Endpoints,name:api-server,namespace:production\nTime range: Last 30 minutes\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Confirm traffic shifted to new pods."]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"-do",children:"\u2705 Do"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Track before applying"})," - Query current state before deployment starts"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Monitor in real-time"})," - Watch Spectre timeline during rollout (auto-refresh UI)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Set time windows"})," - Use deployment start timestamp for accurate queries"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Query related resources"})," - Check Pods, ReplicaSets, Endpoints, and ConfigMaps"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Verify success explicitly"})," - Don't assume success, query for errors"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Integrate with CI/CD"})," - Automate verification in deployment pipelines"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use MCP for triage"})," - Let AI correlate events and suggest fixes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Document deployment windows"})," - Record start/end times for post-mortem analysis"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Monitor endpoints"})," - Ensure service traffic shifts to new pods"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Check old pod termination"})," - Verify graceful shutdown of old replicas"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-dont",children:"\u274c Don't"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't ignore warnings"})," - Warning events often precede failures"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't skip verification"})," - Always check Spectre after deployment completes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't deploy without baseline"})," - Know the current state before making changes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't rely only on kubectl"})," - ",(0,i.jsx)(n.code,{children:"kubectl rollout status"})," doesn't show event details"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't forget config changes"})," - ConfigMap/Secret updates often cause deployment issues"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't assume image exists"})," - ImagePullBackOff is a common early failure"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't ignore readiness failures"})," - Pods Running \u2260 Pods Ready"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't rush rollbacks"})," - Investigate with Spectre first to confirm root cause"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't forget time zones"})," - Use UTC timestamps consistently"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"example-deployment-scenarios",children:"Example Deployment Scenarios"}),"\n",(0,i.jsx)(n.h3,{id:"scenario-1-successful-deployment",children:"Scenario 1: Successful Deployment"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Timeline"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[14:00:00] Deployment/api-server - Updated: replicas 3\u21925, image v1.2\u2192v1.3\n[14:00:02] ReplicaSet/api-server-abc123 - Created (new version)\n[14:00:05] Pod/api-server-abc123-p1 - Created, Status: Pending\n[14:00:05] Pod/api-server-abc123-p2 - Created, Status: Pending\n[14:00:08] Pod/api-server-abc123-p1 - Image pulled, Status: Running\n[14:00:08] Pod/api-server-abc123-p2 - Image pulled, Status: Running\n[14:00:12] Pod/api-server-abc123-p1 - Ready (readiness probe passed)\n[14:00:13] Pod/api-server-abc123-p2 - Ready (readiness probe passed)\n[14:00:15] Endpoints/api-server - Added 2 endpoints\n[14:00:18] Pod/api-server-xyz789-old1 - Terminating\n[14:00:20] ReplicaSet/api-server-xyz789 - Scaled to 3 (old version)\n[14:00:25] Deployment/api-server - Status: Available, Ready: 5/5\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Verification"}),": \u2705 All pods Running and Ready, no errors, endpoints updated."]}),"\n",(0,i.jsx)(n.h3,{id:"scenario-2-failed-deployment-crashloopbackoff",children:"Scenario 2: Failed Deployment (CrashLoopBackOff)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Timeline"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[14:10:00] Deployment/api-server - Updated: image v1.3\u2192v1.4\n[14:10:02] ReplicaSet/api-server-def456 - Created\n[14:10:05] Pod/api-server-def456-p1 - Created, Status: Pending\n[14:10:08] Pod/api-server-def456-p1 - Image pulled, Status: Running\n[14:10:12] Pod/api-server-def456-p1 - Status: Error (Exit code 1)\n[14:10:15] Pod/api-server-def456-p1 - Status: Running (restarted)\n[14:10:18] Pod/api-server-def456-p1 - Status: Error (Exit code 1)\n[14:10:25] Pod/api-server-def456-p1 - Status: CrashLoopBackOff\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Rollback immediately"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl rollout undo deployment/api-server -n production\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Investigation"}),": Check logs for crash reason"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl logs api-server-def456-p1 -n production --previous\n"})}),"\n",(0,i.jsx)(n.h3,{id:"scenario-3-config-change-causes-failure",children:"Scenario 3: Config Change Causes Failure"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Timeline"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[14:20:00] ConfigMap/api-config - Updated: DATABASE_URL changed\n[14:20:05] Deployment/api-server - Rolling update triggered (ConfigMap mounted)\n[14:20:10] Pod/api-server-ghi789-p1 - Created, Status: Running\n[14:20:30] Pod/api-server-ghi789-p1 - Warning: Readiness probe failed\n           (Application can't connect to new database URL)\n[14:21:00] Pod/api-server-ghi789-p1 - Still not Ready (1 minute timeout)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Revert ConfigMap change"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl edit configmap api-config -n production\n# Revert DATABASE_URL to previous value\n\n# Restart deployment to pick up fix\nkubectl rollout restart deployment/api-server -n production\n"})}),"\n",(0,i.jsx)(n.h3,{id:"scenario-4-image-pull-failure",children:"Scenario 4: Image Pull Failure"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Timeline"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'[14:30:00] Deployment/api-server - Updated: image v1.5\n[14:30:02] ReplicaSet/api-server-jkl012 - Created\n[14:30:05] Pod/api-server-jkl012-p1 - Created, Status: Pending\n[14:30:10] Pod/api-server-jkl012-p1 - Status: ErrImagePull\n           Event: "Failed to pull image: manifest unknown"\n[14:30:30] Pod/api-server-jkl012-p1 - Status: ImagePullBackOff\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Root cause"}),": Image tag v1.5 doesn't exist in registry"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Fix image tag"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Verify correct tag\ndocker pull registry.example.com/api-server:v1.5\n# Error: manifest unknown\n\n# Update to correct tag\nkubectl set image deployment/api-server api-server=v1.5.0 -n production\n"})}),"\n",(0,i.jsx)(n.h2,{id:"monitoring-integration",children:"Monitoring Integration"}),"\n",(0,i.jsx)(n.h3,{id:"prometheus-alerts",children:"Prometheus Alerts"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Alert on deployment failures"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'- alert: DeploymentRolloutFailed\n  expr: kube_deployment_status_replicas_unavailable > 0\n  for: 5m\n  annotations:\n    summary: "Deployment {{ $labels.deployment }} has unavailable replicas"\n    runbook: |\n      1. Check Spectre for deployment events:\n         http://spectre/search?query=kind:Deployment,name={{ $labels.deployment }}\n\n      2. Look for pod errors:\n         http://spectre/search?query=kind:Pod,status:Error,namespace={{ $labels.namespace }}\n\n      3. Investigate with MCP or kubectl logs\n'})}),"\n",(0,i.jsx)(n.h3,{id:"gitops-integration-fluxcd",children:"GitOps Integration (FluxCD)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Track Flux reconciliation"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:GitRepository OR kind:Kustomization,namespace:flux-system\nTime range: Last 1 hour\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Correlated timeline"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[14:40:00] GitRepository/flux-system/main - Reconciled (new commit: abc123)\n[14:40:05] Kustomization/flux-system/apps - Applied changes\n[14:40:10] Deployment/api-server - Updated (via Flux)\n[14:40:15] Pods start rolling out...\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use case"}),": Verify GitOps changes propagated correctly from Git to cluster."]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"deployment-not-progressing",children:"Deployment Not Progressing"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptoms"}),": Deployment stuck, no new pods created"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Spectre query"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:Deployment,name:api-server,namespace:production\nTime range: Last 30 minutes\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Possible causes"})," (revealed by events):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ResourceQuota exceeded (Spectre shows quota events)"}),"\n",(0,i.jsx)(n.li,{children:"Node selector doesn't match any nodes (pod stays Pending)"}),"\n",(0,i.jsx)(n.li,{children:"PVC mount failure (pod can't start)"}),"\n",(0,i.jsx)(n.li,{children:"Image pull secrets missing (ImagePullBackOff)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"pods-created-but-not-ready",children:"Pods Created But Not Ready"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptoms"}),": Pods in Running state but not passing readiness checks"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Spectre query"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:Pod,namespace:production,name:api-server\nStatus filter: Warning\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Look for"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Readiness probe failure events"}),"\n",(0,i.jsx)(n.li,{children:"Liveness probe killing pods"}),"\n",(0,i.jsx)(n.li,{children:"Application errors in Events"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Action"}),": Review probe configuration and application startup"]}),"\n",(0,i.jsx)(n.h3,{id:"endpoints-not-updating",children:"Endpoints Not Updating"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptoms"}),": Old pods still receiving traffic after deployment"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Spectre query"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Query: kind:Endpoints,name:api-server,namespace:production\nTime range: Last 15 minutes\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Verify"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Endpoints include new pod IPs"}),"\n",(0,i.jsx)(n.li,{children:"Old pod IPs removed from endpoints"}),"\n",(0,i.jsx)(n.li,{children:"Service selector matches pod labels"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/use-cases/incident-investigation",children:"Incident Investigation"})," - Troubleshoot deployment failures"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/use-cases/post-mortem-analysis",children:"Post-Mortem Analysis"})," - Document deployment incidents"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/mcp-integration/",children:"MCP Integration"})," - AI-assisted deployment verification"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/user-guide/querying-events",children:"User Guide"})," - Master Spectre query syntax"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var s=r(6540);const i={},t=s.createContext(i);function l(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);