"use strict";(globalThis.webpackChunkspectre_docs=globalThis.webpackChunkspectre_docs||[]).push([[284],{4568:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"mcp-integration/tools-reference/resource-changes","title":"resource_changes Tool","description":"Identify and analyze resource changes with impact scoring","source":"@site/docs/mcp-integration/tools-reference/resource-changes.md","sourceDirName":"mcp-integration/tools-reference","slug":"/mcp-integration/tools-reference/resource-changes","permalink":"/spectre/docs/mcp-integration/tools-reference/resource-changes","draft":false,"unlisted":false,"editUrl":"https://github.com/moolen/spectre/tree/master/docs/docs/mcp-integration/tools-reference/resource-changes.md","tags":[],"version":"current","lastUpdatedBy":"Moritz Johner","lastUpdatedAt":1765616329000,"frontMatter":{"title":"resource_changes Tool","description":"Identify and analyze resource changes with impact scoring","keywords":["mcp","tools","resource_changes","incident","analysis","correlation"]},"sidebar":"docsSidebar","previous":{"title":"cluster_health Tool","permalink":"/spectre/docs/mcp-integration/tools-reference/cluster-health"},"next":{"title":"investigate Tool","permalink":"/spectre/docs/mcp-integration/tools-reference/investigate"}}');var i=s(4848),t=s(8453);const c={title:"resource_changes Tool",description:"Identify and analyze resource changes with impact scoring",keywords:["mcp","tools","resource_changes","incident","analysis","correlation"]},l="resource_changes Tool",d={},o=[{value:"Overview",id:"overview",level:2},{value:"Quick Example",id:"quick-example",level:2},{value:"Minimal Usage",id:"minimal-usage",level:3},{value:"Typical Usage",id:"typical-usage",level:3},{value:"Input Parameters",id:"input-parameters",level:2},{value:"Timestamp Format",id:"timestamp-format",level:3},{value:"Impact Threshold Guidelines",id:"impact-threshold-guidelines",level:3},{value:"Output Structure",id:"output-structure",level:2},{value:"Top-Level Fields",id:"top-level-fields",level:3},{value:"ResourceChangeSummary Fields",id:"resourcechangesummary-fields",level:3},{value:"ChangeDetail Fields",id:"changedetail-fields",level:3},{value:"StatusTransition Fields",id:"statustransition-fields",level:3},{value:"Impact Score Algorithm",id:"impact-score-algorithm",level:2},{value:"Scoring Components",id:"scoring-components",level:3},{value:"Example Calculations",id:"example-calculations",level:3},{value:"Impact Score Interpretation",id:"impact-score-interpretation",level:3},{value:"Usage Patterns",id:"usage-patterns",level:2},{value:"Pattern 1: Post-Incident Analysis",id:"pattern-1-post-incident-analysis",level:3},{value:"Pattern 2: Focused Kind Analysis",id:"pattern-2-focused-kind-analysis",level:3},{value:"Pattern 3: Change Volume Assessment",id:"pattern-3-change-volume-assessment",level:3},{value:"Pattern 4: Critical Changes Only",id:"pattern-4-critical-changes-only",level:3},{value:"Pattern 5: Namespace-Scoped Analysis",id:"pattern-5-namespace-scoped-analysis",level:3},{value:"Real-World Examples",id:"real-world-examples",level:2},{value:"Example 1: Deployment Rollout Gone Wrong",id:"example-1-deployment-rollout-gone-wrong",level:3},{value:"Example 2: Maintenance Window Verification",id:"example-2-maintenance-window-verification",level:3},{value:"Example 3: ConfigMap Change Correlation",id:"example-3-configmap-change-correlation",level:3},{value:"Performance Characteristics",id:"performance-characteristics",level:2},{value:"Execution Time",id:"execution-time",level:3},{value:"Optimization Tips",id:"optimization-tips",level:3},{value:"Memory Usage",id:"memory-usage",level:3},{value:"Integration Patterns",id:"integration-patterns",level:2},{value:"Pattern 1: Two-Step Investigation",id:"pattern-1-two-step-investigation",level:3},{value:"Pattern 2: Cluster Health + Resource Changes",id:"pattern-2-cluster-health--resource-changes",level:3},{value:"Pattern 3: Post-Mortem Prompt",id:"pattern-3-post-mortem-prompt",level:3},{value:"Pattern 4: Live Incident Prompt",id:"pattern-4-live-incident-prompt",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Empty Results (<code>changes: []</code>)",id:"empty-results-changes-",level:3},{value:"Low Impact Scores",id:"low-impact-scores",level:3},{value:"High Aggregation Time",id:"high-aggregation-time",level:3},{value:"Incorrect Impact Scores",id:"incorrect-impact-scores",level:3},{value:"MCP Connection Errors",id:"mcp-connection-errors",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"MCP Protocol Request",id:"mcp-protocol-request",level:3},{value:"MCP Protocol Response",id:"mcp-protocol-response",level:3},{value:"cURL Example",id:"curl-example",level:3},{value:"Claude Desktop Usage",id:"claude-desktop-usage",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"\u2705 Do",id:"-do",level:3},{value:"\u274c Don&#39;t",id:"-dont",level:3},{value:"Related Documentation",id:"related-documentation",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"resource_changes-tool",children:"resource_changes Tool"})}),"\n",(0,i.jsx)(n.p,{children:"Analyze Kubernetes resource changes over time with automatic impact scoring and change correlation."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"resource_changes"})," tool identifies which resources changed during a time window, calculates impact scores, and provides detailed change summaries for incident correlation and root cause analysis."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Key Capabilities:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Automatic Impact Scoring"}),": 0-1.0 scale based on error events, warnings, and status transitions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Change Correlation"}),": Group related changes by resource for incident analysis"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Selective Filtering"}),": Focus on specific resource kinds and impact thresholds"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Performance Optimized"}),": Quickly scans large event sets with efficient aggregation"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Correlating multiple changes during an incident"}),"\n",(0,i.jsx)(n.li,{children:"Identifying high-impact changes in a time window"}),"\n",(0,i.jsx)(n.li,{children:"Post-mortem analysis of what changed"}),"\n",(0,i.jsx)(n.li,{children:"Maintenance window verification"}),"\n",(0,i.jsx)(n.li,{children:"Change impact assessment"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"When NOT to Use:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Deep investigation of a single resource (use ",(0,i.jsx)(n.code,{children:"investigate"})," instead)"]}),"\n",(0,i.jsxs)(n.li,{children:["Cluster-wide health overview (use ",(0,i.jsx)(n.code,{children:"cluster_health"})," instead)"]}),"\n",(0,i.jsxs)(n.li,{children:["Browsing resources (use ",(0,i.jsx)(n.code,{children:"resource_explorer"})," instead)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"quick-example",children:"Quick Example"}),"\n",(0,i.jsx)(n.h3,{id:"minimal-usage",children:"Minimal Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Returns all resource changes in the 1-hour window with impact scores."}),"\n",(0,i.jsx)(n.h3,{id:"typical-usage",children:"Typical Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000,\n  "kinds": "Pod,Deployment",\n  "impact_threshold": 0.3,\n  "max_resources": 20\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Returns top 20 Pods and Deployments with impact score \u2265 0.3."}),"\n",(0,i.jsx)(n.h2,{id:"input-parameters",children:"Input Parameters"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Required"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"start_time"})}),(0,i.jsx)(n.td,{children:"int64"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Yes"})}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsx)(n.td,{children:"Start of time window (Unix timestamp in seconds or milliseconds)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"end_time"})}),(0,i.jsx)(n.td,{children:"int64"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Yes"})}),(0,i.jsx)(n.td,{children:"-"}),(0,i.jsx)(n.td,{children:"End of time window (Unix timestamp in seconds or milliseconds)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"kinds"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:'""'})," (all)"]}),(0,i.jsxs)(n.td,{children:["Comma-separated resource kinds to include (e.g., ",(0,i.jsx)(n.code,{children:'"Pod,Deployment"'}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"impact_threshold"})}),(0,i.jsx)(n.td,{children:"float64"}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"0.0"})}),(0,i.jsx)(n.td,{children:"Minimum impact score (0-1.0) to include in results"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"max_resources"})}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"50"})}),(0,i.jsx)(n.td,{children:"Maximum number of resources to return (sorted by impact score descending)"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"timestamp-format",children:"Timestamp Format"}),"\n",(0,i.jsxs)(n.p,{children:["Both ",(0,i.jsx)(n.strong,{children:"Unix seconds"})," and ",(0,i.jsx)(n.strong,{children:"Unix milliseconds"})," are supported:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// Unix seconds (recommended)\n{"start_time": 1702382400, "end_time": 1702386000}\n\n// Unix milliseconds\n{"start_time": 1702382400000, "end_time": 1702386000000}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Tip"}),": Use ",(0,i.jsx)(n.code,{children:"date +%s"})," for Unix seconds or ",(0,i.jsx)(n.code,{children:"date +%s%3N"})," for milliseconds."]}),"\n",(0,i.jsx)(n.h3,{id:"impact-threshold-guidelines",children:"Impact Threshold Guidelines"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Threshold"}),(0,i.jsx)(n.th,{children:"Use Case"}),(0,i.jsx)(n.th,{children:"Typical Results"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"0.0"})}),(0,i.jsx)(n.td,{children:"All changes (default)"}),(0,i.jsx)(n.td,{children:"High volume, includes routine updates"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"0.2"})}),(0,i.jsx)(n.td,{children:"Moderate changes"}),(0,i.jsx)(n.td,{children:"Filters out routine updates, keeps warnings"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"0.3"})}),(0,i.jsx)(n.td,{children:"High-impact changes"}),(0,i.jsx)(n.td,{children:"Errors, status transitions, significant events"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"0.5"})}),(0,i.jsx)(n.td,{children:"Critical changes only"}),(0,i.jsx)(n.td,{children:"Multiple errors or severe status transitions"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"0.7"})}),(0,i.jsx)(n.td,{children:"Extreme severity"}),(0,i.jsx)(n.td,{children:"Rare, very high event counts or cascading failures"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"output-structure",children:"Output Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "changes": [\n    {\n      "resource_id": "Pod/default/nginx-7d8b5f9c6b-x7k2p",\n      "kind": "Pod",\n      "namespace": "default",\n      "name": "nginx-7d8b5f9c6b-x7k2p",\n      "impact_score": 0.75,\n      "changes": [\n        {\n          "timestamp": 1702384200,\n          "event_type": "UPDATE",\n          "change_type": "status.phase",\n          "old_value": "Running",\n          "new_value": "Failed"\n        }\n      ],\n      "change_count": 3,\n      "event_count": 12,\n      "error_events": 2,\n      "warning_events": 1,\n      "status_transitions": [\n        {\n          "timestamp": 1702384200,\n          "from_status": "Running",\n          "to_status": "Failed"\n        }\n      ]\n    }\n  ],\n  "total_resources": 47,\n  "filtered_resources": 8,\n  "time_range_ms": 3600000,\n  "aggregation_time_ms": 245\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"top-level-fields",children:"Top-Level Fields"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"changes"})}),(0,i.jsx)(n.td,{children:"array"}),(0,i.jsx)(n.td,{children:"List of resource change summaries (sorted by impact score descending)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"total_resources"})}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:"Total number of resources with events in time window"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"filtered_resources"})}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:"Number of resources matching filters (kinds, threshold)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"time_range_ms"})}),(0,i.jsx)(n.td,{children:"int64"}),(0,i.jsx)(n.td,{children:"Query time range duration in milliseconds"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"aggregation_time_ms"})}),(0,i.jsx)(n.td,{children:"int64"}),(0,i.jsx)(n.td,{children:"Processing time in milliseconds"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"resourcechangesummary-fields",children:"ResourceChangeSummary Fields"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"resource_id"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["Unique resource identifier (format: ",(0,i.jsx)(n.code,{children:"Kind/Namespace/Name"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"kind"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["Resource kind (e.g., ",(0,i.jsx)(n.code,{children:"Pod"}),", ",(0,i.jsx)(n.code,{children:"Deployment"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"namespace"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Kubernetes namespace"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"name"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Resource name"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"impact_score"})}),(0,i.jsx)(n.td,{children:"float64"}),(0,i.jsxs)(n.td,{children:["Calculated impact score (0-1.0) - see ",(0,i.jsx)(n.a,{href:"#impact-score-algorithm",children:"Impact Score Algorithm"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"changes"})}),(0,i.jsx)(n.td,{children:"array"}),(0,i.jsx)(n.td,{children:"List of specific changes detected (field modifications)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"change_count"})}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:"Number of distinct changes (unique field modifications)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"event_count"})}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:"Total number of events for this resource"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"error_events"})}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:'Number of events with severity "Error"'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"warning_events"})}),(0,i.jsx)(n.td,{children:"int"}),(0,i.jsx)(n.td,{children:'Number of events with severity "Warning"'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"status_transitions"})}),(0,i.jsx)(n.td,{children:"array"}),(0,i.jsx)(n.td,{children:"State transitions (e.g., Running \u2192 Failed)"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"changedetail-fields",children:"ChangeDetail Fields"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"timestamp"})}),(0,i.jsx)(n.td,{children:"int64"}),(0,i.jsx)(n.td,{children:"Unix timestamp when change occurred"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"event_type"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["Event type: ",(0,i.jsx)(n.code,{children:"CREATE"}),", ",(0,i.jsx)(n.code,{children:"UPDATE"}),", ",(0,i.jsx)(n.code,{children:"DELETE"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"change_type"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["Field path that changed (e.g., ",(0,i.jsx)(n.code,{children:"status.phase"}),", ",(0,i.jsx)(n.code,{children:"spec.replicas"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"old_value"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Previous value (JSON-encoded)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"new_value"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"New value (JSON-encoded)"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"statustransition-fields",children:"StatusTransition Fields"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"timestamp"})}),(0,i.jsx)(n.td,{children:"int64"}),(0,i.jsx)(n.td,{children:"Unix timestamp of transition"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"from_status"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["Previous status (e.g., ",(0,i.jsx)(n.code,{children:"Running"}),", ",(0,i.jsx)(n.code,{children:"Pending"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"to_status"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsxs)(n.td,{children:["New status (e.g., ",(0,i.jsx)(n.code,{children:"Failed"}),", ",(0,i.jsx)(n.code,{children:"Error"}),")"]})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"impact-score-algorithm",children:"Impact Score Algorithm"}),"\n",(0,i.jsxs)(n.p,{children:["Impact scores range from ",(0,i.jsx)(n.strong,{children:"0.0 (no impact)"})," to ",(0,i.jsx)(n.strong,{children:"1.0 (maximum impact)"})," and are calculated based on:"]}),"\n",(0,i.jsx)(n.h3,{id:"scoring-components",children:"Scoring Components"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'Base Score = 0.0\n\n+ 0.30  if resource has error events (error_events > 0)\n+ 0.15  if resource has warning events (warning_events > 0)\n+ 0.30  for each status transition to "Error"\n+ 0.15  for each status transition to "Warning"\n+ 0.10  if event count > 10 (high activity)\n\nFinal Score = min(Base Score, 1.0)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-calculations",children:"Example Calculations"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example 1: Pod CrashLoopBackOff"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Error events: 3 \u2192 +0.30\nWarning events: 0 \u2192 +0.00\nStatus transition: Running \u2192 Error \u2192 +0.30\nEvent count: 15 \u2192 +0.10\n-------------------------------\nImpact Score: 0.70\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example 2: Deployment Scale Up"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Error events: 0 \u2192 +0.00\nWarning events: 0 \u2192 +0.00\nStatus transitions: none \u2192 +0.00\nEvent count: 5 \u2192 +0.00\n-------------------------------\nImpact Score: 0.00 (routine change)\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example 3: Service with Warnings"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Error events: 0 \u2192 +0.00\nWarning events: 2 \u2192 +0.15\nStatus transitions: none \u2192 +0.00\nEvent count: 8 \u2192 +0.00\n-------------------------------\nImpact Score: 0.15\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example 4: Multiple Transitions"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Error events: 1 \u2192 +0.30\nWarning events: 1 \u2192 +0.15\nStatus transitions: Pending \u2192 Warning (2\xd7) \u2192 +0.30\nEvent count: 12 \u2192 +0.10\n-------------------------------\nBase Score: 0.85 \u2192 Capped at 1.0\nImpact Score: 0.85\n"})}),"\n",(0,i.jsx)(n.h3,{id:"impact-score-interpretation",children:"Impact Score Interpretation"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Score Range"}),(0,i.jsx)(n.th,{children:"Severity"}),(0,i.jsx)(n.th,{children:"Typical Cause"}),(0,i.jsx)(n.th,{children:"Action"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0.0 - 0.1"}),(0,i.jsx)(n.td,{children:"Routine"}),(0,i.jsx)(n.td,{children:"Normal updates, scale events"}),(0,i.jsx)(n.td,{children:"Monitor"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0.1 - 0.3"}),(0,i.jsx)(n.td,{children:"Low Impact"}),(0,i.jsx)(n.td,{children:"Warnings, minor issues"}),(0,i.jsx)(n.td,{children:"Review if clustered"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0.3 - 0.5"}),(0,i.jsx)(n.td,{children:"Moderate"}),(0,i.jsx)(n.td,{children:"Errors, status transitions"}),(0,i.jsx)(n.td,{children:"Investigate"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0.5 - 0.7"}),(0,i.jsx)(n.td,{children:"High Impact"}),(0,i.jsx)(n.td,{children:"Multiple errors, significant transitions"}),(0,i.jsx)(n.td,{children:"Urgent investigation"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0.7 - 1.0"}),(0,i.jsx)(n.td,{children:"Critical"}),(0,i.jsx)(n.td,{children:"Cascading failures, extreme event counts"}),(0,i.jsx)(n.td,{children:"Immediate action"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"usage-patterns",children:"Usage Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"pattern-1-post-incident-analysis",children:"Pattern 1: Post-Incident Analysis"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": Identify all high-impact changes during an incident"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000,\n  "impact_threshold": 0.3,\n  "max_resources": 30\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Case"}),': "What changed during the incident at 10:00 AM that could have caused the outage?"']}),"\n",(0,i.jsx)(n.h3,{id:"pattern-2-focused-kind-analysis",children:"Pattern 2: Focused Kind Analysis"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": Analyze changes to specific resource types"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000,\n  "kinds": "Deployment,StatefulSet,DaemonSet",\n  "impact_threshold": 0.2\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Case"}),': "Were there any controller changes during the maintenance window?"']}),"\n",(0,i.jsx)(n.h3,{id:"pattern-3-change-volume-assessment",children:"Pattern 3: Change Volume Assessment"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": Get all changes (no filtering) to assess overall activity"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000,\n  "impact_threshold": 0.0,\n  "max_resources": 100\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Case"}),': "How many resources changed in the last hour?"']}),"\n",(0,i.jsx)(n.h3,{id:"pattern-4-critical-changes-only",children:"Pattern 4: Critical Changes Only"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": Find only the most severe changes"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702378800,\n  "end_time": 1702386000,\n  "impact_threshold": 0.5,\n  "max_resources": 10\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use Case"}),': "What were the top 10 most impactful changes in the last 2 hours?"']}),"\n",(0,i.jsx)(n.h3,{id:"pattern-5-namespace-scoped-analysis",children:"Pattern 5: Namespace-Scoped Analysis"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": Analyze changes in a specific namespace"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000,\n  "kinds": "Pod",\n  "impact_threshold": 0.2\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Then filter results by namespace in post-processing (namespace is included in output)."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": MCP tool does not support namespace filtering directly. Use Spectre API ",(0,i.jsx)(n.code,{children:"/api/v1/query?namespace=default"})," for namespace filtering."]}),"\n",(0,i.jsx)(n.h2,{id:"real-world-examples",children:"Real-World Examples"}),"\n",(0,i.jsx)(n.h3,{id:"example-1-deployment-rollout-gone-wrong",children:"Example 1: Deployment Rollout Gone Wrong"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Scenario"}),": A deployment update caused pods to crash"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000,\n  "kinds": "Deployment,Pod",\n  "impact_threshold": 0.3,\n  "max_resources": 20\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response"})," (abbreviated):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "changes": [\n    {\n      "resource_id": "Pod/production/api-server-85f6c9b8-k4x2p",\n      "kind": "Pod",\n      "namespace": "production",\n      "name": "api-server-85f6c9b8-k4x2p",\n      "impact_score": 0.75,\n      "changes": [\n        {\n          "timestamp": 1702384200,\n          "event_type": "UPDATE",\n          "change_type": "status.phase",\n          "old_value": "Running",\n          "new_value": "Failed"\n        },\n        {\n          "timestamp": 1702384150,\n          "event_type": "UPDATE",\n          "change_type": "status.containerStatuses[0].restartCount",\n          "old_value": "0",\n          "new_value": "3"\n        }\n      ],\n      "change_count": 5,\n      "event_count": 18,\n      "error_events": 3,\n      "warning_events": 2,\n      "status_transitions": [\n        {\n          "timestamp": 1702384200,\n          "from_status": "Running",\n          "to_status": "Failed"\n        }\n      ]\n    },\n    {\n      "resource_id": "Deployment/production/api-server",\n      "kind": "Deployment",\n      "namespace": "production",\n      "name": "api-server",\n      "impact_score": 0.45,\n      "changes": [\n        {\n          "timestamp": 1702384000,\n          "event_type": "UPDATE",\n          "change_type": "spec.template.spec.containers[0].image",\n          "old_value": "api-server:v1.2.0",\n          "new_value": "api-server:v1.3.0"\n        }\n      ],\n      "change_count": 2,\n      "event_count": 8,\n      "error_events": 1,\n      "warning_events": 0,\n      "status_transitions": []\n    }\n  ],\n  "total_resources": 47,\n  "filtered_resources": 8,\n  "time_range_ms": 3600000,\n  "aggregation_time_ms": 187\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Analysis"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Deployment image change (v1.2.0 \u2192 v1.3.0) correlated with pod failures"}),"\n",(0,i.jsx)(n.li,{children:"Pod impact score 0.75 (high) due to errors and status transition"}),"\n",(0,i.jsx)(n.li,{children:"Deployment impact score 0.45 due to error events"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-2-maintenance-window-verification",children:"Example 2: Maintenance Window Verification"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Scenario"}),": Verify no unexpected changes during maintenance"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702378800,\n  "end_time": 1702382400,\n  "impact_threshold": 0.2,\n  "max_resources": 50\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "changes": [\n    {\n      "resource_id": "Node/worker-node-3",\n      "kind": "Node",\n      "namespace": "",\n      "name": "worker-node-3",\n      "impact_score": 0.25,\n      "changes": [\n        {\n          "timestamp": 1702380000,\n          "event_type": "UPDATE",\n          "change_type": "status.conditions[0].status",\n          "old_value": "True",\n          "new_value": "Unknown"\n        }\n      ],\n      "change_count": 1,\n      "event_count": 4,\n      "error_events": 0,\n      "warning_events": 1,\n      "status_transitions": []\n    }\n  ],\n  "total_resources": 12,\n  "filtered_resources": 1,\n  "time_range_ms": 3600000,\n  "aggregation_time_ms": 98\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Analysis"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Only 1 resource exceeded threshold (0.2)"}),"\n",(0,i.jsx)(n.li,{children:"Node condition change was expected (planned maintenance)"}),"\n",(0,i.jsx)(n.li,{children:"Verification successful: no unexpected high-impact changes"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-3-configmap-change-correlation",children:"Example 3: ConfigMap Change Correlation"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Scenario"}),": Find what changed around a configuration update"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Request"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382100,\n  "end_time": 1702382700,\n  "kinds": "ConfigMap,Deployment,Pod",\n  "impact_threshold": 0.0,\n  "max_resources": 30\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response"})," (abbreviated):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "changes": [\n    {\n      "resource_id": "ConfigMap/default/app-config",\n      "kind": "ConfigMap",\n      "namespace": "default",\n      "name": "app-config",\n      "impact_score": 0.1,\n      "changes": [\n        {\n          "timestamp": 1702382200,\n          "event_type": "UPDATE",\n          "change_type": "data.database_url",\n          "old_value": "postgres://old-db:5432",\n          "new_value": "postgres://new-db:5432"\n        }\n      ],\n      "change_count": 1,\n      "event_count": 2,\n      "error_events": 0,\n      "warning_events": 0,\n      "status_transitions": []\n    },\n    {\n      "resource_id": "Pod/default/app-7d9f8c5b-z9k3p",\n      "kind": "Pod",\n      "namespace": "default",\n      "name": "app-7d9f8c5b-z9k3p",\n      "impact_score": 0.0,\n      "changes": [\n        {\n          "timestamp": 1702382350,\n          "event_type": "UPDATE",\n          "change_type": "metadata.annotations.config-hash",\n          "old_value": "abc123",\n          "new_value": "def456"\n        }\n      ],\n      "change_count": 1,\n      "event_count": 3,\n      "error_events": 0,\n      "warning_events": 0,\n      "status_transitions": []\n    }\n  ],\n  "total_resources": 8,\n  "filtered_resources": 8,\n  "time_range_ms": 600000,\n  "aggregation_time_ms": 42\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Analysis"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ConfigMap change at 10:03:20"}),"\n",(0,i.jsx)(n.li,{children:"Pod config hash updated 2.5 minutes later (config propagation)"}),"\n",(0,i.jsx)(n.li,{children:"Low impact scores indicate routine configuration update"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"performance-characteristics",children:"Performance Characteristics"}),"\n",(0,i.jsx)(n.h3,{id:"execution-time",children:"Execution Time"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Time Range"}),(0,i.jsx)(n.th,{children:"Event Count"}),(0,i.jsx)(n.th,{children:"Avg Execution Time"}),(0,i.jsx)(n.th,{children:"P95 Execution Time"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1 hour"}),(0,i.jsx)(n.td,{children:"~1,000"}),(0,i.jsx)(n.td,{children:"50-100 ms"}),(0,i.jsx)(n.td,{children:"150 ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"6 hours"}),(0,i.jsx)(n.td,{children:"~6,000"}),(0,i.jsx)(n.td,{children:"150-250 ms"}),(0,i.jsx)(n.td,{children:"400 ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"24 hours"}),(0,i.jsx)(n.td,{children:"~25,000"}),(0,i.jsx)(n.td,{children:"500-800 ms"}),(0,i.jsx)(n.td,{children:"1,200 ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"7 days"}),(0,i.jsx)(n.td,{children:"~175,000"}),(0,i.jsx)(n.td,{children:"3-5 seconds"}),(0,i.jsx)(n.td,{children:"8 seconds"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": Execution time depends on:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Event volume in time window"}),"\n",(0,i.jsx)(n.li,{children:"Number of unique resources"}),"\n",(0,i.jsx)(n.li,{children:"Complexity of change detection (field-level diffs)"}),"\n",(0,i.jsx)(n.li,{children:"Cache hit rate (block cache)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"optimization-tips",children:"Optimization Tips"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"1. Limit Time Range"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// Slower: 7-day window\n{"start_time": 1702209600, "end_time": 1702814400}\n\n// Faster: 1-hour window\n{"start_time": 1702382400, "end_time": 1702386000}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"2. Filter by Kind"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// Slower: All kinds\n{"kinds": ""}\n\n// Faster: Specific kinds\n{"kinds": "Pod,Deployment"}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"3. Use Impact Threshold"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// Slower: All changes (more processing)\n{"impact_threshold": 0.0}\n\n// Faster: High-impact only (filtered early)\n{"impact_threshold": 0.3}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"4. Reduce Max Resources"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// Slower: Return 100 resources\n{"max_resources": 100}\n\n// Faster: Return top 10 resources\n{"max_resources": 10}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"memory-usage",children:"Memory Usage"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Estimated Memory:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Memory = event_count \xd7 2 KB (average event size) + overhead\n\n1 hour (~1,000 events): ~2 MB\n24 hours (~25,000 events): ~50 MB\n7 days (~175,000 events): ~350 MB\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": Tool processes events in streaming fashion; memory usage is bounded by result set size."]}),"\n",(0,i.jsx)(n.h2,{id:"integration-patterns",children:"Integration Patterns"}),"\n",(0,i.jsx)(n.h3,{id:"pattern-1-two-step-investigation",children:"Pattern 1: Two-Step Investigation"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 1"}),": Find high-impact changes with ",(0,i.jsx)(n.code,{children:"resource_changes"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000,\n  "impact_threshold": 0.5,\n  "max_resources": 10\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 2"}),": Investigate top resource with ",(0,i.jsx)(n.code,{children:"investigate"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "resource_kind": "Pod",\n  "resource_namespace": "default",\n  "resource_name": "nginx-7d8b5f9c6b-x7k2p",\n  "start_time": 1702382400,\n  "end_time": 1702386000\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"pattern-2-cluster-health--resource-changes",children:"Pattern 2: Cluster Health + Resource Changes"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 1"}),": Get cluster overview with ",(0,i.jsx)(n.code,{children:"cluster_health"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Step 2"}),": Find what changed in unhealthy kinds"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "start_time": 1702382400,\n  "end_time": 1702386000,\n  "kinds": "Pod,Deployment",\n  "impact_threshold": 0.3\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"pattern-3-post-mortem-prompt",children:"Pattern 3: Post-Mortem Prompt"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"post_mortem_incident_analysis"})," prompt uses ",(0,i.jsx)(n.code,{children:"resource_changes"})," internally:"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"})," (Claude Desktop):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Analyze incident at 10:00 AM on December 12, 2024\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Behind the scenes"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Calls ",(0,i.jsx)(n.code,{children:"cluster_health"})," for overview"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Calls ",(0,i.jsx)(n.code,{children:"resource_changes"})]})," to identify impactful changes"]}),"\n",(0,i.jsxs)(n.li,{children:["Calls ",(0,i.jsx)(n.code,{children:"investigate"})," for top resources"]}),"\n",(0,i.jsx)(n.li,{children:"Generates comprehensive RCA report"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"pattern-4-live-incident-prompt",children:"Pattern 4: Live Incident Prompt"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"live_incident_handling"})," prompt uses ",(0,i.jsx)(n.code,{children:"resource_changes"})," for correlation:"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"})," (Claude Desktop):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Help me troubleshoot pods failing in production namespace\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Behind the scenes"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Calls ",(0,i.jsx)(n.code,{children:"cluster_health"})," with ",(0,i.jsx)(n.code,{children:"namespace=production"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:["Calls ",(0,i.jsx)(n.code,{children:"resource_changes"})]})," to find recent changes"]}),"\n",(0,i.jsx)(n.li,{children:"Provides immediate mitigation guidance"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(n.h3,{id:"empty-results-changes-",children:["Empty Results (",(0,i.jsx)(n.code,{children:"changes: []"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": Tool returns empty array"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Common Causes:"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"1. No events in time range"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "changes": [],\n  "total_resources": 0,\n  "filtered_resources": 0\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),": Expand time range or verify Spectre is receiving events"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"2. Impact threshold too high"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// Request\n{"impact_threshold": 0.8}\n\n// Response\n{"total_resources": 47, "filtered_resources": 0}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),": Lower threshold (try 0.0 to see all changes)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"3. Kind filter too restrictive"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// Request\n{"kinds": "StatefulSet"}\n\n// Response\n{"total_resources": 47, "filtered_resources": 0}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),": Expand kinds or remove filter"]}),"\n",(0,i.jsx)(n.h3,{id:"low-impact-scores",children:"Low Impact Scores"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": All resources have impact_score < 0.2"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Possible Causes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Normal cluster operations (expected)"}),"\n",(0,i.jsx)(n.li,{children:"No errors or warnings in time window"}),"\n",(0,i.jsx)(n.li,{children:"Routine updates (scale, annotations, labels)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),": This may be expected. Use ",(0,i.jsx)(n.code,{children:"impact_threshold: 0.0"})," to see all changes."]}),"\n",(0,i.jsx)(n.h3,{id:"high-aggregation-time",children:"High Aggregation Time"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": ",(0,i.jsx)(n.code,{children:"aggregation_time_ms > 5000"})," (5 seconds)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Causes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Very large time range (7+ days)"}),"\n",(0,i.jsx)(n.li,{children:"High event volume (100k+ events)"}),"\n",(0,i.jsx)(n.li,{children:"Cold cache (first query after restart)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Solutions:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Reduce time range"}),"\n",(0,i.jsx)(n.li,{children:"Filter by specific kinds"}),"\n",(0,i.jsxs)(n.li,{children:["Increase ",(0,i.jsx)(n.code,{children:"--cache-max-mb"})," in Spectre server"]}),"\n",(0,i.jsx)(n.li,{children:"Add more memory to cache blocks"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"incorrect-impact-scores",children:"Incorrect Impact Scores"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": Resource has high impact but no errors visible"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Cause"}),": Impact score includes:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Error events (may not be in ",(0,i.jsx)(n.code,{children:"changes"})," array)"]}),"\n",(0,i.jsx)(n.li,{children:"Warning events"}),"\n",(0,i.jsx)(n.li,{children:"Status transitions"}),"\n",(0,i.jsx)(n.li,{children:"High event count (>10)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solution"}),": Check all fields:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "impact_score": 0.55,\n  "error_events": 2,        // \u2190 Check this\n  "warning_events": 1,      // \u2190 And this\n  "status_transitions": [   // \u2190 And this\n    {"from_status": "Running", "to_status": "Error"}\n  ],\n  "event_count": 15         // \u2190 And this (>10 adds 0.1)\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"mcp-connection-errors",children:"MCP Connection Errors"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptom"}),": Tool call fails with connection error"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"1. Verify MCP server is running"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl get pods -l app=spectre\nkubectl logs spectre-server-0 -c mcp\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"2. Check MCP endpoint"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:8081/mcp \\\n  -H "Content-Type: application/json" \\\n  -d \'{"jsonrpc":"2.0","method":"tools/list","params":{},"id":1}\'\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"3. Verify Spectre API connectivity"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:8080/api/v1/health\n"})}),"\n",(0,i.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,i.jsx)(n.h3,{id:"mcp-protocol-request",children:"MCP Protocol Request"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "method": "tools/call",\n  "params": {\n    "name": "resource_changes",\n    "arguments": {\n      "start_time": 1702382400,\n      "end_time": 1702386000,\n      "kinds": "Pod,Deployment",\n      "impact_threshold": 0.3,\n      "max_resources": 20\n    }\n  },\n  "id": 1\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"mcp-protocol-response",children:"MCP Protocol Response"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "jsonrpc": "2.0",\n  "result": {\n    "content": [\n      {\n        "type": "text",\n        "text": "{\\"changes\\":[...],\\"total_resources\\":47,\\"filtered_resources\\":8}"\n      }\n    ]\n  },\n  "id": 1\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": Response is JSON-encoded string in ",(0,i.jsx)(n.code,{children:"text"})," field."]}),"\n",(0,i.jsx)(n.h3,{id:"curl-example",children:"cURL Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST http://localhost:8081/mcp \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "jsonrpc": "2.0",\n    "method": "tools/call",\n    "params": {\n      "name": "resource_changes",\n      "arguments": {\n        "start_time": 1702382400,\n        "end_time": 1702386000,\n        "impact_threshold": 0.3\n      }\n    },\n    "id": 1\n  }\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"claude-desktop-usage",children:"Claude Desktop Usage"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Natural Language"})," (leverages prompts):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Show me high-impact changes in the last hour\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Direct Tool Call"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Use the resource_changes tool with:\n- start_time: 1702382400\n- end_time: 1702386000\n- impact_threshold: 0.3\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": Claude Desktop automatically formats MCP requests; no manual JSON required."]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"-do",children:"\u2705 Do"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use impact thresholds"})," - Filter noise with ",(0,i.jsx)(n.code,{children:"impact_threshold: 0.3"})," for incident analysis"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Limit time ranges"})," - Query 1-6 hours for fast results"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Filter by kind"})," - Focus on relevant resource types with ",(0,i.jsx)(n.code,{children:"kinds"})," parameter"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Set max_resources"})," - Use ",(0,i.jsx)(n.code,{children:"max_resources: 10-20"})," for actionable results"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Combine with investigate"})," - Use resource_changes to find targets, then investigate deeply"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Interpret impact scores contextually"})," - Score 0.3 for Deployment \u2260 score 0.3 for Pod"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Check total_resources vs filtered_resources"})," - Verify filtering isn't too aggressive"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use for correlation"})," - Identify temporal relationships between changes"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-dont",children:"\u274c Don't"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't query >7 days"})," - Execution time becomes slow (3-8 seconds)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't ignore impact_threshold"})," - Unfiltered results can be overwhelming"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't over-interpret scores"})," - Impact score is heuristic, not absolute truth"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't rely solely on changes array"})," - Check error_events, warning_events, status_transitions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't use for single resource investigation"})," - Use ",(0,i.jsx)(n.code,{children:"investigate"})," tool instead"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't assume namespace filtering"})," - Tool doesn't filter by namespace; use Spectre API query"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't ignore aggregation_time_ms"})," - If >1s, consider optimizing query"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Don't use for real-time monitoring"})," - Tool analyzes historical data, not live state"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-documentation",children:"Related Documentation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/mcp-integration/tools-reference/cluster-health",children:"cluster_health Tool"})," - Cluster-wide health overview"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/mcp-integration/tools-reference/investigate",children:"investigate Tool"})," - Deep investigation of specific resources"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/mcp-integration/tools-reference/resource-explorer",children:"resource_explorer Tool"})," - Browse and discover resources"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/mcp-integration/prompts-reference/post-mortem",children:"Post-Mortem Prompt"})," - Uses resource_changes in workflow"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/mcp-integration/prompts-reference/live-incident",children:"Live Incident Prompt"})," - Uses resource_changes for correlation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"/spectre/docs/configuration/mcp-configuration",children:"MCP Configuration"})," - MCP server deployment"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var r=s(6540);const i={},t=r.createContext(i);function c(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);